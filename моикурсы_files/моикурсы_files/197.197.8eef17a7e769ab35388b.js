(window.webpackJsonp=window.webpackJsonp||[]).push([[197],{1015:function(e,t,s){"use strict";s.r(t);s(11),s(7),s(12),s(25),s(105),s(43),s(65);var n=s(22),i=s(845),r=s(374),a=s(1834),o=s(860),l=s(2035),_=s(2220),u=s(522),c=s(27),p=s(1827),m=s(2221),d=s(2058),h={name:"client-step-content-root",components:{UserNavigationButtons:m.a,ClientStepElementDetail:_.a,StepContent:l.a},props:{no_header_buttons:{required:!1,default:function _default(){return!1}}},data:function data(){return{user_data:this.$store.state.login.user_data,django_urls:n.b,unit_detail_links:p.c}},watch:{"$route.params.unit_id":function $routeParamsUnit_id(){var e=Object(u.c)(this.$store.state,this.unit_id);if(e){var t=e.get_timing();e.values.is_timer_solution&&t.is_started()&&!e.values.is_started&&this.unit_navigator.to_unit_content(this.$router,{unit_id:this.unit_id})}}},computed:{navigation_steps:function navigation_steps(){return new d.b(this.$store.state,this.$route.params.classes_id).get_steps()},step:function step(){return new o.a(this.$store.state.models.steps[this.$route.params.step_id],this.$store.state)},step_id:function step_id(){return this.$route.params.step_id},unit_id:function unit_id(){return this.$store.state.models.steps[this.step_id].unit_id},unit_navigator:function unit_navigator(){return new a.b(+this.$route.params.classes_id,this.$store.state)},units:function units(){var e=this;return this.unit_navigator.units_ids.map((function(t){return new r.a(e.$store.state.models.units[t],e.$store.state)})).sort((function(e,t){return e.values.number-t.values.number})).filter((function(t){var s=Object(u.b)(e.$store.state,t.values.id);return!(t.values.private||!s.is_started())}))},steps:function steps(){return Object(c.k)(this.units,(function(e){return e.steps}))},have_problem:function have_problem(){return this.step.step_elements.filter((function(e){return e.problem})).length},cur_unit:function cur_unit(){var e=this;return this.units.find((function(t){return t.values.id===e.step.values.unit_id}))},is_show_unit_results_link:function is_show_unit_results_link(){return this.cur_unit.is_need_score()&&!this.is_textbook},problem_contest:function problem_contest(){if(this.have_problem){var e=this.step.step_elements.filter((function(e){return e.problem}))[0].problem.values.id;return new i.a(this.$store.state.models.problem_contests[e],this.$store.state)}return null},contest_id:function contest_id(){if(this.$route.params.unit_id)return this.$store.state.models.units[this.$route.params.unit_id].contest;var e=+this.$route.params.step_id,t=this.$store.state.models.steps[e].unit_id;return this.$store.state.models.units[t].contest},is_textbook:function is_textbook(){return this.$route.meta&&"textbook_"===this.$route.meta.name_prefix}}},f=s(3),v=Object(f.a)(h,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.cur_unit?s("step-content",{key:e.$route.params.step_id.toString(),attrs:{step_id:e.step_id,step_element_id:e.$route.params.step_element_id,change_navigation:!0},scopedSlots:e._u([{key:"step_element",fn:function(t){return[s("client-step-element-detail",{attrs:{step_element:t.step_element,step:e.step}})]}}],null,!1,1905240650)},[s("template",{slot:"header"},[e._v("\n    "+e._s(e.step.values.number)+". "+e._s(e.step.values.title)+"\n    "),e.no_header_buttons?e._e():[e.is_show_unit_results_link?s("router-link",{staticClass:"pull-right m-l-xs",attrs:{to:{name:"unit_results_list",params:{unit_id:e.unit_id}}}},[s("i",{staticClass:"icon-trophy"})]):e._e(),e._v(" "),e.have_problem?s("a",{staticClass:"pull-right",attrs:{href:e.django_urls["api:contest_statements_api"](e.problem_contest.values.contest_id)}},[s("i",{staticClass:"icon-print"})]):e._e()]],2),e._v(" "),e._v(" "),s("template",{slot:"footer"},[s("UserNavigationButtons",{attrs:{steps:e.navigation_steps,current_step_id:"step_id:"+e.$route.params.step_id}})],1)],2):e.user_data.is_teacher?s("div",{staticClass:"m-lg"},[s("h1",{staticClass:"text-center text-muted"},[e._v("\n    "+e._s(e.$gettext("Блок еще не начался или недоступен для ученика"))+"\n  ")])]):e._e()}),[],!1,null,null,null);t.default=v.exports},1827:function(e,t,s){"use strict";s.d(t,"c",(function(){return r})),s.d(t,"a",(function(){return o})),s.d(t,"d",(function(){return a})),s.d(t,"e",(function(){return l})),s.d(t,"b",(function(){return _}));var n=s(13),i=s.n(n);s(11),s(7),s(12),s(33),s(36),s(25),s(23),s(28),s(38);function ownKeys(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(s),!0).forEach((function(t){i()(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ownKeys(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function get_prefixed_name(e,t){return e&&e.meta&&e.meta.name_prefix?e.meta.name_prefix+t:t}var r={unit_link:function unit_link(e,t,s){return{name:get_prefixed_name(e,"unit_content"),params:{classes_id:s||e.params.classes_id,unit_id:t.values.id}}},step_link:function step_link(e,t,s){return{name:get_prefixed_name(e,"step_content_root"),params:{step_id:t.values.id,unit_id:t.values.unit_id,classes_id:e.params.classes_id||s}}},step_element_link:function step_element_link(e,t,s,n){return{name:get_prefixed_name(e,n||"step_element_content"),params:{classes_id:e.params.classes_id||s,step_id:t.values.step_id,step_element_id:t.values.id}}},step_element_detail_link:function step_element_detail_link(e,t,s){return r.step_element_link(e,t,s,"step_element_detail")}},a=_objectSpread(_objectSpread({},r),{},{unit_link:function unit_link(e,t){return{name:"unit_edit",params:{unit_id:t.values.id}}}}),o=_objectSpread(_objectSpread({},r),{},{unit_link:function unit_link(e,t){return{name:"contest_edit",params:{unit_id:t.values.id}}}}),l=_objectSpread(_objectSpread({},r),{},{unit_link:function unit_link(e,t){if(t.values.steps)return{name:"import_step_content",params:{step_id:t.values.steps[0],unit_id:t.values.id,import_id:e.params.import_id}}},step_link:function step_link(e,t){return{name:"import_step_content",params:{step_id:t.values.id,unit_id:t.values.unit_id,import_id:e.params.import_id}}},step_element_link:function step_element_link(e,t){return{name:"import_step_element_content",params:{import_id:e.params.import_id,step_id:t.values.step_id,step_element_id:t.values.id}}}}),_=_objectSpread(_objectSpread({},r),{},{unit_link:function unit_link(e,t){return{name:"classes_checking_problem",params:{unit_id:t.values.id}}},step_link:function step_link(e,t){return{name:"classes_checking",params:{step_id:t.values.id,unit_id:t.values.unit_id}}},step_element_link:function step_element_link(e,t){return{name:"classes_checking_problem",params:{classes_id:e.params.classes_id,step_id:t.values.step_id,step_element_id:t.values.id}}}})},1834:function(e,t,s){"use strict";s.d(t,"b",(function(){return u})),s.d(t,"a",(function(){return c}));var n=s(4),i=s.n(n),r=s(5),a=s.n(r),o=(s(11),s(7),s(12),s(153),s(105),s(25),s(43),s(53),s(96),s(374)),l=s(268),_=s(132),u=function(){function UnitNavigator(e,t){var s;i()(this,UnitNavigator),this.classes_id=e,this.state=t,this.prefix=this.state.result.is_preview_mode?"results_":"",this.is_client=!!this.state.result.is_preview_mode||this.state.login.user_data.is_client,this.classes=this.state.models.classes&&this.state.models.classes[e]&&new l.a(this.state.models.classes[e],this.state),this.course_id=null===(s=this.classes)||void 0===s?void 0:s.values.course_id,this.is_abstract=this.classes&&"A"===this.classes.course.values.usage,this.is_abstract&&(this.prefix="abstract_"+this.prefix)}return a()(UnitNavigator,[{key:"units_ids",get:function get(){var e=this,t=[],s=this.state.models.units&&Object.values(this.state.models.units);return s&&(s.sort((function(e,t){return e.number-t.number})),this.prefix&&!this.is_abstract&&(s=s.filter((function(e){return!1===e.private}))),s.map((function(s){String(s.classes_id)===String(e.classes_id)&&t.push(s.id)}))),t}},{key:"route",value:function route(e){var t=this.units_ids;if(t.length){var s={unit_id:t[0],classes_id:this.classes_id};this.is_abstract&&this.course_id&&(s.course_id=this.course_id),e.replace({name:this.prefix+"unit_content",params:s})}else this.is_client||(this.is_abstract?e.replace({name:this.prefix+"classes_lessons_add_theme"}):e.replace({name:this.prefix+"classes_lessons"}))}},{key:"next",value:function next(e){var t=this.units_ids;if(t.length){var s={unit_id:t[0]};e({name:this.prefix+"unit_content",params:s})}else this.is_client||(this.is_abstract?e({name:this.prefix+"classes_lessons_add_theme"}):e({name:this.prefix+"classes_lessons"}))}},{key:"get_link",value:function get_link(){var e=this.units_ids;if(e.length){var t={unit_id:e[0]};return{name:this.prefix+"unit_content",params:t}}return this.is_client?{name:this.prefix+"classes_content"}:this.is_abstract?{name:this.prefix+"classes_lessons_add_theme"}:{name:this.prefix+"classes_lessons"}}},{key:"to_step_content_root",value:function to_step_content_root(e,t){e.replace({name:this.prefix+"step_content_root",params:t})}},{key:"to_unit_content",value:function to_unit_content(e,t){e.push({name:this.prefix+"unit_content",params:t})}}]),UnitNavigator}(),c=function(){function UnitImportNavigator(e,t,s){i()(this,UnitImportNavigator),this.classes_id=t,this.import_id=e,this.state=s}return a()(UnitImportNavigator,[{key:"route",value:function route(e){var t=this.state.models.classes[this.import_id].units;if(t.length&&this.state.models.units[t[0]]){var s=new o.a(this.state.models.units[t[0]],this.state),n={unit_id:t[0],classes_id:this.classes_id,import_id:this.import_id,step_id:s.steps.length&&s.steps[0].values.id},i=Object(_.c)(e.currentRoute,"import_step_content");e.replace({name:i,params:n})}else if(!this.state.login.user_data.is_client){var r=Object(_.c)(e.currentRoute,"classes_lessons");e.replace({name:r})}}},{key:"next",value:function next(e){var t=this.units_ids;t.length?e({name:"import_step_content",params:{unit_id:t[0]}}):this.state.login.user_data.is_client||e({name:"classes_lessons"})}},{key:"get_link",value:function get_link(){var e=this.units_ids;return e.length?{name:"import_step_content",params:{unit_id:e[0]}}:this.state.login.user_data.is_client?{name:"classes_content"}:{name:"classes_lessons"}}}]),UnitImportNavigator}()},2035:function(e,t,s){"use strict";var n=s(34),i=s.n(n),r=s(20),a=s.n(r),o=(s(7),s(32),s(68),s(102),s(103),s(41),s(53),s(96),s(272),s(11),s(12),s(82),s(860));function sleep(e){return new Promise((function(t){return setTimeout(t,e)}))}var l={name:"step-content",props:{step_id:{required:!0},step_element_id:{required:!1},change_navigation:{default:!1}},data:function data(){return{timer_url_lock:null}},watch:{step_element_id:function step_element_id(e){this.$route.params.dont_scroll||this.scrollToElement(Number(e))}},computed:{elements:function elements(){return this.step.step_elements},step:function step(){return new o.a(this.$store.state.models.steps[this.step_id],this.$store.state)}},mounted:function mounted(){this.change_navigation&&(document.addEventListener("scroll",this.throttle_update_hash),this.$route.name.includes("step_content_root")&&this.update_router_step_element_id(),this.step_element_id&&this.scrollToElement(Number(this.step_element_id),250))},beforeDestroy:function beforeDestroy(){this.change_navigation&&document.removeEventListener("scroll",this.throttle_update_hash)},methods:{scrollToElement:function scrollToElement(e){var t=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!this.$store.state.models.step_elements[e])return"step_content_root"!==this.$route.meta.name&&"import_step_content"!==this.$route.meta.name?this.$router.replace({name:(this.$store.state.result.is_preview_mode?"results_":"")+"step_content_root"}):this.$refs.step_elements&&this.$scrollTo(this.$refs.step_elements[0],200);this.$nextTick(i()(a.a.mark((function _callee(){var n,i,r;return a.a.wrap((function _callee$(a){for(;;)switch(a.prev=a.next){case 0:if(n=t.elements.findIndex((function(t){return t.values.id===e})),i=e&&-1!==n&&t.$refs.step_elements[n],r=200,!s){a.next=7;break}return a.next=6,sleep(s);case 6:r=1;case 7:i&&t&&t.$scrollTo(i,r);case 8:case"end":return a.stop()}}),_callee)}))))},get_visible_step_element:function get_visible_step_element(){for(var e=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,t=this.$refs.step_elements&&this.$refs.step_elements.length-1;t>=0;){if(this.$refs.step_elements[t].getBoundingClientRect().top<e/3)return this.elements[t];t-=1}},update_router_step_element_id:function update_router_step_element_id(){var e=this.get_visible_step_element(),t=this.$route.params.step_element_id||"";if(e&&t.toString()!==e.values.id.toString()){var s=this.$route.name;s.includes("step_content_root")&&(s=s.replace("step_content_root","step_element_content")),this.$router.replace({name:s,params:{step_element_id:e.values.id,dont_scroll:!0}}).catch((function(){}))}},throttle_update_hash:function throttle_update_hash(){var e=this;this.timer_url_lock&&window.clearTimeout(this.timer_url_lock),this.timer_url_lock=window.setTimeout((function(){e.update_router_step_element_id(),e.timer_url_lock=null}),100)}}},_=s(3),u=Object(_.a)(l,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e._t("pre_header"),e._v(" "),s("div",{staticClass:"step_element__title"},[e._t("header",(function(){return[e._v(e._s(e.step.values.number)+". "+e._s(e.step.values.title)+" ")]}))],2),e._v(" "),e._t("aside"),e._v(" "),s("hr",{staticClass:"no-top"}),e._v(" "),e._l(e.elements,(function(t){return s("div",{key:t.uid,ref:"step_elements",refInFor:!0},[e._t("step_element",null,{step_element:t})],2)})),e._v(" "),e._t("footer")],2)}),[],!1,null,null,null);t.a=u.exports},2220:function(e,t,s){"use strict";s(11),s(7),s(32),s(29),s(12);var n=s(860),i={name:"client-step-element-detail",components:{"testing-detail":function TestingAttemptRoot(){return Promise.all([s.e(3),s.e(2),s.e(0),s.e(1),s.e(5),s.e(6),s.e(9),s.e(32),s.e(345)]).then(s.bind(null,3054))},"problem-detail":function ClientProblemContestRoot(){return Promise.all([s.e(3),s.e(8),s.e(10),s.e(2),s.e(0),s.e(1),s.e(5),s.e(6),s.e(9),s.e(101)]).then(s.bind(null,2855))},"webinar-detail":function WebinarClientRoot(){return Promise.all([s.e(3),s.e(2),s.e(0),s.e(1),s.e(5),s.e(6),s.e(9),s.e(43),s.e(284)]).then(s.bind(null,2730))},"video-detail":function VideoClientRoot(){return Promise.all([s.e(3),s.e(2),s.e(0),s.e(1),s.e(5),s.e(6),s.e(9),s.e(283)]).then(s.bind(null,2733))},"article-detail":function ArticleClientRoot(){return Promise.all([s.e(3),s.e(2),s.e(0),s.e(1),s.e(5),s.e(6),s.e(9),s.e(194)]).then(s.bind(null,2732))},"material-detail":function MaterialClientRoot(){return Promise.all([s.e(3),s.e(8),s.e(2),s.e(0),s.e(1),s.e(5),s.e(6),s.e(9),s.e(59),s.e(472)]).then(s.bind(null,2856))},"scratch-detail":function ClientScratchProblemRoot(){return Promise.all([s.e(3),s.e(2),s.e(0),s.e(1),s.e(5),s.e(6),s.e(9),s.e(238)]).then(s.bind(null,3053))},"sandbox-detail":function SandboxRoot(){return Promise.all([s.e(3),s.e(2),s.e(0),s.e(1),s.e(5),s.e(6),s.e(9),s.e(22),s.e(74),s.e(473)]).then(s.bind(null,2771))}},props:{step_element:{required:!0,type:s(839).a},step:{required:!1,type:n.a}},data:function data(){return{component_name:"".concat(this.step_element.values.type,"-detail")}},computed:{attrs:function attrs(){return{material:this.step_element.material,webinar:this.step_element.webinar,video:this.step_element.video,article:this.step_element.article,scratch_problem:this.step_element.scratch_problem,problem_contest:this.step_element.problem,testing_id:this.step_element.values.testing_id,problem:"problem-detail"===this.component_name&&this.step_element.problem,sandbox:this.step_element.sandbox,step_element:this.step_element}}}},r=s(3),a=Object(r.a)(i,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e.attrs?s(e.component_name,e._b({tag:"component"},"component",e.attrs,!1),[s("template",{slot:"name_prefix"},[s("span",{staticClass:"m-r-sm"},[e._v(e._s(e.step&&e.step.values.number)+"."),s("span",{staticClass:"order_index"},[e._v(e._s(e.step_element.values.number))])])])],2):e._e()],1)}),[],!1,null,null,null);t.a=a.exports}}]);
//# sourceMappingURL=197.197.8eef17a7e769ab35388b.js.map