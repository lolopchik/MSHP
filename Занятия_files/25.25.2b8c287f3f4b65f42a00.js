(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{2022:function(t,e,s){"use strict";var n=s(19),a=s.n(n),i=s(80),o=s(268),r=s(245),l=s(520),c=s(1692),_=s(640),u=s(148),d=s(149),f={name:"ClientClassesNotificationCard",components:{TextEllipsis:s(1779).a,RemainDate:_.a},props:{classes:{type:o.a,required:!0},icon_class:{type:String,required:!1,default:""}},data:function data(){return{ONE_MINUTE:d.f}},methods:{minutes_formatter:u.e}},p=s(3),m=Object(p.a)(f,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"modern-placement"},[s("div",{staticClass:"h4 flex gap-xs flex-wrap"},[t._t("header",(function(){return[s("RemainDate",{attrs:{value:t.classes.moment_begin,period:t.ONE_MINUTE,formatter:t.minutes_formatter},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.formatted;return[s("div",{staticClass:"mb"},[t._v("\n            "+t._s(t.$gettext("Занятие начнется через"))+" "+t._s(n)+"\n          ")])]}}])})]}))],2),t._v(" "),s("div",{staticClass:"flex flex-space-between gap-standart"},[s("div",{staticClass:"flex-column gap-sm flex-grow-1"},[s("TextEllipsis",{staticClass:"text-subtitle"},[t._v("\n        "+t._s(t.classes.course.values.simplest_name)+"\n      ")]),t._v(" "),s("span",{staticClass:"text-label"},[t._v("\n        "+t._s(t._f("moment")(t.classes.moment_begin,"LT"))+" -\n        "+t._s(t._f("moment")(t.classes.moment_end,"LT"))+"\n      ")])],1),t._v(" "),s("RouterLink",{staticClass:"btn-modern-white",attrs:{tag:"button",to:{name:"classes_unit_content",params:{classes_id:t.classes.values.id}}}},[s("i",{staticClass:"shp_icons-nav-arrow-right",class:t.icon_class})])],1)])}),[],!1,null,null,null).exports,v={name:"ClientClassesNotification",components:{EventTimerLayout:c.a,ClientClassesNotificationCard:m},props:{classes:{type:o.a,required:!0}}},h=Object(p.a)(v,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("EventTimerLayout",{attrs:{start_at:t.classes.values.datetime_begin,end_at:t.classes.values.datetime_end,use_default_timer:!1}},[s("ClientClassesNotificationCard",{staticClass:"modern-placement-bgc-warning",attrs:{slot:"before_start",icon_class:"text-warning",classes:t.classes},slot:"before_start"}),t._v(" "),s("ClientClassesNotificationCard",{staticClass:"modern-placement-bgc-success",attrs:{slot:"started",icon_class:"text-success",classes:t.classes},slot:"started",scopedSlots:t._u([{key:"header",fn:function(){return[t._v("\n      "+t._s(t.$gettext("Занятие началось"))+"\n    ")]},proxy:!0}])})],1)}),[],!1,null,null,null).exports,g=s(527),C={name:"PupilNotifications",components:{ClientClassesNotification:h,ListFetcher:i.a},data:function data(){var t=[{applied:{datetime_end__gte:a()().toISOString(),datetime_begin__lte:a()().add(15,"minutes").toISOString(),orderBy:"datetime_begin",course__usage__in:"B,D,S",course__role__in:g.g,schema:JSON.stringify(l.d)}}];return{ClassesData:o.a,classes_filter:t,classes_model:r.a}}},b=Object(p.a)(C,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ListFetcher",{attrs:{url:"api:classes_extended_list_api",limit:"1",filters:t.classes_filter,model:t.classes_model,data_presenter:t.ClassesData},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.data;return[n.length>0?s("ClientClassesNotification",{staticClass:"mb",attrs:{classes:n[0]}}):t._e(),t._v(" "),n.length>0?t._t("divider"):t._e()]}}],null,!0)})}),[],!1,null,null,null);e.a=b.exports},2087:function(t,e,s){"use strict";var n=s(933),a=s(430),i={name:"NavigationQuestionsButton",components:{TopRightRedDotWrapper:n.a},computed:{has_unread_questions:function has_unread_questions(){return Object(a.b)(this.$store.state)>0}}},o=s(3),r=Object(o.a)(i,(function(){var t=this.$createElement,e=this._self._c||t;return e("RouterLink",{staticClass:"btn-modern btn-modern-link-grey flex flex-vertical-center",attrs:{to:{name:"discussion_list"}}},[e("TopRightRedDotWrapper",{staticClass:"bg-white",attrs:{show_notification:this.has_unread_questions}},[e("i",{staticClass:"shp_icons-messages_messages_2"})])],1)}),[],!1,null,null,null);e.a=r.exports},2097:function(t,e,s){"use strict";s(68);var n=s(77),a=s(80),i=s(2182),o=s(631),r=s(1619),l=s(2022),c=s(21),_=s(22),u=s(107),d={name:"NotificationsDropdown",components:{Dropdown:n.Dropdown,ListFetcher:a.a,FeedEvent:i.a,PupilNotifications:l.a},data:function data(){return{feed_events_model:o.a,FeedEventData:r.a,is_open:!1,watch_key:0}},computed:{no_notifications_text:function no_notifications_text(){return this.$gettext("Новых уведомлений нет,")+"<br/>"+this.$gettext("но скоро появятся.")+"<br/>"+this.$gettext("Заглядывай почаще!")},count:function count(){return Number(this.$store.state.context.unread_notification_count)}},methods:{open_handler:function open_handler(){this.is_open&&(this.is_open=!1)},set_count:function set_count(t,e,s,n){this.set_global_count(n)},set_global_count:function set_global_count(t){Object(u.a)(this.$store,"unread_notification_count",Number(t))},get_new_notifications_count:function get_new_notifications_count(){var t=this;new c.a(_.b["api:feed_events_list_api"](),"notifications_dropdown").get().on_success((function(e,s,n,a,i){return t.set_global_count(i)})).execute(this.$store,{schema:JSON.stringify({fields:["id"]}),limit:1,read_at__isnull:!0})}},watch:{is_open:function is_open(t){var e=document.getElementById("content-wrapper");t?e.addEventListener("scroll",this.open_handler):e.removeEventListener("scroll",this.open_handler)},count:function count(){this.watch_key++}},created:function created(){this.get_new_notifications_count()},mounted:function mounted(){var t,e=null===(t=this.$refs.root)||void 0===t?void 0:t.$refs.dropdown;e&&e.classList.add("notifications-dropdown")}},f=s(3),p=Object(f.a)(d,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Dropdown",{ref:"root",staticClass:"inline-flex",attrs:{"append-to-body":"","menu-right":""},model:{value:t.is_open,callback:function(e){t.is_open=e},expression:"is_open"}},[s("button",{staticClass:"btn-modern btn-modern-link-grey notification-button"},[t._t("button_icon",(function(){return[s("i",{staticClass:"shp_icons-notifications_notification text-subtext-color"})]})),t._v(" "),t.count?s("span",{staticClass:"notification-dot"}):t._e()],2),t._v(" "),s("div",{staticClass:"modern-page notifications-dropdown-container",attrs:{slot:"dropdown"},slot:"dropdown"},[s("ListFetcher",{attrs:{url:"api:feed_events_list_api",limit:"10",filters:[{applied:{read_at__isnull:!0}}],is_need:t.is_open,model:t.feed_events_model,data_presenter:t.FeedEventData,watch_key:t.watch_key},on:{fetched:t.set_count},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.data;return[s("div",{ref:"header",staticClass:"notifications-dropdown-header"},[s("div",{staticClass:"flex flex-vertical-center gap-xs"},[s("h4",{staticClass:"m-none"},[t._v("\n              "+t._s(t.$gettext("Уведомления"))+"\n            ")]),t._v(" "),t.count?s("div",{staticClass:"flex flex-vertical-center"},[s("i",{staticClass:"shp_icons-point shp_icons-lg mr-xs"}),t._v(" "),s("h4",{staticClass:"m-none"},[t._v("\n                "+t._s(t.count)+"\n              ")])]):t._e()]),t._v(" "),s("i",{staticClass:"shp_icons-modern_close clickable",on:{click:function(e){t.is_open=!1}}})]),t._v(" "),s("div",{staticClass:"notifications-dropdown-content"},[s("PupilNotifications",{staticClass:"mt mb"}),t._v(" "),n.length?s("div",{staticClass:"feed-events-container mt"},t._l(n.filter((function(t){return!t.values.hidden})),(function(t){return s("FeedEvent",{key:t.uid,staticClass:"notifications-dropdown-event",attrs:{feed_event:t}})})),1):s("div",{staticClass:"empty-content",domProps:{innerHTML:t._s(t.no_notifications_text)}})],1),t._v(" "),s("div",{staticClass:"notifications-dropdown-footer"},[s("RouterLink",{staticClass:"btn-modern-link",attrs:{tag:"button",to:{name:"notifications_list"}}},[t._v("\n            "+t._s(t.$gettext("Перейти к странице уведомлений"))+"\n          ")])],1)]}}])})],1)])}),[],!1,null,null,null);e.a=p.exports},521:function(t,e,s){"use strict";s(11),s(7),s(12);var n=s(48),a={name:"UserAvatar",components:{Avatar:s(627).a},props:{user:{type:n.a,required:!1},size:{type:String,default:"38px"},font_size:{type:String,default:"18px"},avatar_class:{type:String,default:""}},computed:{avatar_url:function avatar_url(){return this.user&&this.user.values.avatar},initials:function initials(){return this.user&&this.user.short_initials}}},i=s(3),o=Object(i.a)(a,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"inline-block"},[e("Avatar",this._b({attrs:{avatar_url:this.avatar_url,initials:this.initials}},"Avatar",this.$props,!1))],1)}),[],!1,null,null,null);e.a=o.exports}}]);
//# sourceMappingURL=25.25.2b8c287f3f4b65f42a00.js.map