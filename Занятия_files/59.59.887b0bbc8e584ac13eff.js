(window.webpackJsonp=window.webpackJsonp||[]).push([[59],{1872:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var a=i(4),s=i.n(a),n=i(5),l=i.n(n),r=i(1),o=function(){function FieldEditConfig(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(r.isRequired)(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(r.isRequired)();s()(this,FieldEditConfig),this.field_name="name",this.model=e,this.url=t,this.default="",this.namespace=void 0,this.detail_state=void 0}return l()(FieldEditConfig,[{key:"for_field",value:function for_field(e){return this.field_name=e,this}},{key:"use_default",value:function use_default(e){return this.default=e,this}},{key:"use_namespace",value:function use_namespace(e){return this.namespace=e,this}}]),FieldEditConfig}()},1928:function(e,t,i){},1979:function(e,t,i){"use strict";i(11),i(7),i(12),i(41);var a=i(63),s=i(945),n=i(144),l=i(21),r=i(1704),o=i(110),c=i(121),f=i(1872),d={name:"instance-name-edit",components:{FormField:n.a,FieldInlineWrapper:s.a,AlertError:a.a},props:{instance:{required:!0},config:{required:!0,type:f.a},classes:{required:!1,default:"row"},active:{required:!1,default:!1}},data:function data(){var e=new c.a(this,this.instance.uid).with_fields([new o.a(this.config.field_name).use_type("input2").label("").max_length(100).add_options({fieldClasses:"material__input"})]),t=e.extract_initials(this.instance.values);return this.config.default&&(t[this.config.field_name]=this.config.default),{formEngine:e,form_data:t}},methods:{save:function save(){var e=this;return new l.a(this.config.url,this.instance.uid).patch().on_before(l.c.hide_errors(this.formEngine.name)).on_success(l.c.update_instance(this.config.model)).on_success((function(){return e.instance.action_operator.set(e.$store,e.config.detail_state,e.config.namespace)})).parse_errors(this.formEngine).execute(this.$store,this.form_data)}},mounted:function mounted(){var e=this;this.formEngine.call_field_component(this.config.field_name,(function(t){t.$refs.form_field.focus(),e.hotkey_handler=new r.a(t.$refs.form_field).on_enter.push((function(){return e.save()})).on_escape.push((function(){return e.instance.action_operator.set(e.$store,e.config.detail_state,e.config.namespace)}))}))},beforeDestroy:function beforeDestroy(){this.hotkey_handler&&this.hotkey_handler.destroy()}},u=(i(1999),i(3)),_=Object(u.a)(d,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{class:e.classes},[i("alert-error",{staticClass:"no-top",attrs:{uid:e.instance.uid}}),e._v(" "),i("div",{staticClass:"form-inline inline-block",class:{instance_name_edit__input:e.active,instance_name_edit__field:!e.active}},e._l(e.formEngine.fields,(function(t){return i("field-inline-wrapper",{key:t.name,attrs:{field:t,model:e.form_data,formEngine:e.formEngine}},[i("form-field",{attrs:{field:t,model:e.form_data,formEngine:e.formEngine}})],1)})),1),e._v(" "),i("div",{staticClass:"inline-block m-r-xs",class:{instance_name_edit__icons:e.active}},[i("a",{staticClass:"icon-save instance_name_edit__btn icon-large",on:{click:e.save}}),e._v(" "),i("a",{staticClass:"icon-undo instance_name_edit__btn",on:{click:function(t){return e.instance.action_operator.set(e.$store,e.config.detail_state,e.config.namespace)}}})])],1)}),[],!1,null,null,null);t.a=_.exports},1999:function(e,t,i){"use strict";i(1928)},2019:function(e,t,i){},2026:function(e,t,i){"use strict";i(11),i(7),i(12),i(31);var a=i(855),s=i(22),n=i(1781),l=(i(1717),i(379)),r=i(97),o=i(880),c={name:"material-file-text",components:{SpinnerWave:i(157).a},props:{file:{type:a.a,required:!0}},data:function data(){var e=new r.c(s.b["api:material_file_content_api"](this.file.values.id),o.a);return{server_instance:new l.b("material_file:".concat(this.file.values.id),e)}},created:function created(){this.server_instance.fetch(this.$store)},beforeDestroy:function beforeDestroy(){this.server_instance.destroy(this.$store)}},f=i(3),d={name:"material-file-content",components:{MaterialFileText:Object(f.a)(c,(function(){var e=this.$createElement,t=this._self._c||e;return this.server_instance.initiated?t("div",{staticClass:"codehilite material-file__text-content",domProps:{innerHTML:this._s(this.file.values.content)}}):t("div",[t("spinner-wave")],1)}),[],!1,null,null,null).exports,ShpVideo:n.a},props:{file:{type:a.a,required:!0}},computed:{file_link:function file_link(){return s.b["api:material_file_download_api"](this.file.values.id)},viewer_src:function viewer_src(){return"/static/ViewerJS/index.html#../../".concat(this.file_link.substr(1))},thumbnail_viewer_src:function thumbnail_viewer_src(){return"/static/ViewerJS/index.html#".concat(this.file.values.thumbnail_file)},google_docs_src:function google_docs_src(){return"https://docs.google.com/gview?url=".concat(window.location.origin).concat(this.file.values.file,"&embedded=true")}}},u=Object(f.a)(d,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("template",{slot:"header"},[e._v(e._s(e.file.values.full_name))]),e._v(" "),"text"===e.file.values.renderer||"markdown"===e.file.values.renderer?i("div",[i("material-file-text",{attrs:{file:e.file}}),e._v(" "),e._t("text")],2):"pdf"===e.file.values.renderer?i("div",{staticClass:"embed-responsive embed-responsive-16by9 sticky-modal-content"},[i("iframe",{staticClass:"embed-responsive-item",attrs:{src:e.viewer_src,width:"400",height:"300",allowfullscreen:"",webkitallowfullscreen:""}})]):e.file.values.thumbnail_file?i("div",{staticClass:"embed-responsive embed-responsive-16by9 sticky-modal-content"},[i("iframe",{attrs:{src:e.thumbnail_viewer_src}})]):"xls"===e.file.values.renderer||"office"===e.file.values.renderer?i("div",{staticClass:"embed-responsive embed-responsive-16by9 sticky-modal-content"},[i("iframe",{attrs:{src:e.google_docs_src}})]):"video"===e.file.values.renderer?i("shp-video",{attrs:{type:e.file.values.mime,source:e.file.values.file}}):"image"===e.file.values.renderer?i("div",{staticClass:"text-center sticky-modal-content"},[i("img",{staticClass:"img-responsive inline-block",attrs:{src:e.file_link}})]):"binary"===e.file.values.renderer?i("div",{staticClass:"bold text-center material-file__text-content"},[e._t("binary")],2):"psd"===e.file.values.renderer?i("div",{staticClass:"sticky-modal-content"},[i("div",{staticClass:"text-center"},[i("img",{staticClass:"img-responsive inline-block",attrs:{src:e.file.values.thumbnail}})]),e._v(" "),e._t("psd")],2):i("div",[e._v("\n    not found\n  ")])],2)}),[],!1,null,null,null);t.a=u.exports},2104:function(e,t,i){"use strict";var a=i(855),s={name:"material-file-container",components:{MaterialFileHeader:i(2105).a},props:{file:{type:a.a,required:!0},footer:{required:!1,default:!1}}},n=(i(2179),i(3)),l=Object(n.a)(s,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"large-icons col-padding-sm col-md-4 col-xs-6 clearfix file-content"},[i("div",{staticClass:"shp-file"},[i("div",{staticClass:"file-thumbnail shp-full-width"},[e._t("header",(function(){return[i("material-file-header",{attrs:{file:e.file}})]})),e._v(" "),i("div",{staticClass:"col-rectangle"},[i("div",{staticClass:"media shp-full-width full-height text-center nowrap",on:{click:function(t){return e.file.action_operator.set(e.$store,"preview")}}},[e._t("content"),e._v(" "),i("span",{staticClass:"vertical-line"})],2)]),e._v(" "),e.footer?i("div",{staticClass:"file-footer-container"},[i("div",{staticClass:"file-footer no-bottom"},[e._t("footer")],2)]):e._e()],2)])])}),[],!1,null,null,null);t.a=l.exports},2105:function(e,t,i){"use strict";var a=i(855),s=i(1825),n={name:"MaterialFileHeader",props:{file:{required:!0,type:a.a}},computed:{is_editable:function is_editable(){return!this.$store.state.login.user_data.is_client&&!this.$store.state.result.is_preview_mode&&this.$has_permission(s.a,!0)}}},l=i(3),r=Object(l.a)(n,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.file.action_info.is("edit","heading")?e._e():i("div",{staticClass:"file-header-container"},[i("div",{staticClass:"file-header nowrap presentation-btn"},[i("div",{staticClass:"file-header-icon"},[i("span",{staticClass:"file-icon"},[i("i",{class:e.file.get_icon()})])]),e._v(" "),i("div",{staticClass:"file-name-spacer"},[e._v(e._s(e.file.values.full_name))]),e._v(" "),i("div",{staticClass:"file-extension-spacer"},[e._v(e._s(e.file.values.extension))]),e._v(" "),i("div",{staticClass:"shp-file-title instance_name_edit__input"},[i("div",{staticClass:"shp-file-name"},[e._v("\n               "+e._s(e.file.values.name)+"\n          ")]),e._v(" "),i("div",{staticClass:"file-extension instance_name_edit__icons"},[e._v(e._s(e.file.values.extension)+"\n            "),e.is_editable?i("a",{staticClass:"icon-pencil inline-block m-l-sm",on:{click:function(t){return e.file.action_operator.set(e.$store,"edit","heading")}}}):e._e()])])])])}),[],!1,null,null,null);t.a=r.exports},2179:function(e,t,i){"use strict";i(2019)},2208:function(e,t,i){"use strict";i(11),i(7),i(12),i(41);var a=i(855),s=i(63),n=i(22),l=i(21),r=i(880),o={name:"MaterialListFileRemove",components:{AlertError:s.a},props:{file:{required:!0,type:a.a}},methods:{remove:function remove(){var e=n.b["api:material_file_delete_api"](this.file.values.id);new l.a(e,this.file.uid).on_success(l.c.remove_instance(this.file.values.id,r.a)).on_before(l.c.hide_errors(this.file.uid)).on_error(l.c.show_errors(this.file.uid)).execute(this.$store,{})}}},c=i(3),f=Object(c.a)(o,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"panel-body"},[i("alert-error",{attrs:{uid:e.file.uid}},[i("template",{slot:"no-errors"},[i("div",{staticClass:"bs-callout bs-callout-danger no-top"},[i("h4",[e._v(e._s(e.$gettext("Вы уверены, что хотите удалить файл?")))])]),e._v(" "),i("div",{staticClass:"col-xs-10 col-xs-offset-1"},[i("button",{staticClass:"btn btn-inverse",class:e.file.action_info.disabled_dict,on:{click:e.remove}},[i("i",{staticClass:"icon-trash"}),e._v(" "+e._s(e.$gettext("Удалить")))]),e._v(" "),i("a",{staticClass:"btn btn-default pull-right",on:{click:function(t){return e.file.action_operator.detail(e.$store)}}},[i("i",{staticClass:"icon-undo"}),e._v(" "+e._s(e.$gettext("Отменить")))])])])],2)],1)])}),[],!1,null,null,null).exports,d=i(1979),u=i(1872),_=i(2026),m=i(1825),v={name:"MaterialListFileContainer",components:{MaterialFileContent:_.a,InstanceNameEdit:d.a,MaterialListFileRemove:f},props:{file:{required:!0,type:a.a}},data:function data(){return{unit_is_editable:m.a}},computed:{name_edit_config:function name_edit_config(){return new u.a(r.a,n.b["api:material_file_update_api"](this.file.values.id)).for_field("name").use_namespace("heading").use_default(this.file.values.name)}}},p=Object(c.a)(v,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"panel panel-default mb-lg"},[i("div",{staticClass:"panel-heading"},[i("div",{staticClass:"row flex flex-vertical-center",staticStyle:{"min-height":"34px"}},[i("div",{staticClass:"col-xs-11"},[e.file.action_info.is("edit","heading")?i("instance-name-edit",{attrs:{active:!1,instance:e.file,config:e.name_edit_config}}):[i("span",{staticClass:"material__title"},[e._v(e._s(e.file.values.full_name))])]],2),e._v(" "),i("div",{staticClass:"col-xs-1 flex flex-end"},[i("a",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$gettext("Сохранить"),expression:"$gettext('Сохранить')"}],staticClass:"mr",attrs:{gettext:"Сохранить",href:e.file.download_url}},[i("i",{staticClass:"icon-download-alt icon-large"})]),e._v(" "),!e.$store.state.login.user_data.is_client&&e.$has_permission(e.unit_is_editable,!0)?[i("a",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$gettext("Редактировать"),expression:"$gettext('Редактировать')"}],staticClass:"mr",attrs:{gettext:"Редактировать"},on:{click:function(t){return e.file.action_operator.set(e.$store,"edit","heading")}}},[i("i",{staticClass:"icon-pencil icon-large"})]),e._v(" "),i("a",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$gettext("Удалить"),expression:"$gettext('Удалить')"}],staticClass:"mr",attrs:{gettext:"Удалить"},on:{click:function(t){return e.file.action_operator.remove(e.$store)}}},[i("i",{staticClass:"icon-trash icon-large"})])]:e._e()],2)])]),e._v(" "),i("div",[e.file.action_info.is_detail?i("material-file-content",{attrs:{file:e.file}}):e._e(),e._v(" "),e.file.action_info.is_remove?i("material-list-file-remove",{attrs:{file:e.file}}):e._e()],1)])}),[],!1,null,null,null);t.a=p.exports},2277:function(e,t,i){"use strict";i(11),i(7),i(12);var a=i(855),s=i(22),n={name:"material-file-preview",components:{MaterialFileContent:i(2026).a},props:{file:{type:a.a,required:!0}},data:function data(){return{is_open:!0}},computed:{file_link:function file_link(){return s.b["api:material_file_download_api"](this.file.values.id)}},methods:{to_detail:function to_detail(){this.file.action_operator.detail(this.$store)}}},l=i(3),r=Object(l.a)(n,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("modal",{staticClass:"modal-extra-large",attrs:{footer:!1,"append-to-body":!0,title:e.file.values.full_name},on:{hide:e.to_detail},model:{value:e.is_open,callback:function(t){e.is_open=t},expression:"is_open"}},[i("material-file-content",{attrs:{file:e.file}},[i("template",{slot:"binary"},[i("a",{attrs:{href:e.file_link}},[e._v(e._s(e.$gettext("Загрузить")))])]),e._v(" "),i("template",{slot:"text"},[i("div",{staticClass:"bold text-center"},[i("a",{attrs:{href:e.file_link}},[e._v(e._s(e.$gettext("Загрузить")))])])]),e._v(" "),i("template",{slot:"psd"},[i("div",{staticClass:"bold text-center"},[i("a",{attrs:{href:e.file_link}},[e._v(e._s(e.$gettext("Загрузить")))])])])],2)],1)}),[],!1,null,null,null);t.a=r.exports},2856:function(e,t,i){"use strict";i.r(t);var a=i(895),s=i(855),n={name:"material-file-client-detail",components:{MaterialFileContainer:i(2104).a},props:{file:{required:!0,type:s.a}}},l=i(3),r=Object(l.a)(n,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("material-file-container",{attrs:{file:e.file,footer:!0}},[i("template",{slot:"content"},[i("img",{staticClass:"media-object img-responsive inline-block clickable",class:{"img-responsive-height":!e.file.values.thumbnail},attrs:{src:e.file.thumbnail_url}}),e._v(" "),i("span",{staticClass:"vertical-line"})]),e._v(" "),i("template",{slot:"footer"},[i("a",{attrs:{href:e.file.download_url}},[i("i",{staticClass:"icon-download-alt"}),e._v("\n      "+e._s(e.$gettext("скачать"))+"\n    ")])])],2)}),[],!1,null,null,null).exports,o=i(2277),c=i(2208),f=i(1628),d={name:"material-client-detail",components:{MaterialListFileContainer:c.a,MaterialFilePreview:o.a,MaterialFileClientDetail:r,FadeTransition:f.a},props:{material:{type:a.a,required:!0}}},u=Object(l.a)(d,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",["list"===e.material.values.display_type?[i("fade-transition",{attrs:{group:""}},e._l(e.material.material_files,(function(e){return i("material-list-file-container",{key:e.values.id,attrs:{file:e}})})),1)]:i("div",{staticClass:"panel panel-default step-element"},[i("div",{staticClass:"panel-background clearfix"},e._l(e.material.material_files,(function(t,a){return i("div",{key:a},[i("material-file-client-detail",{attrs:{file:t}}),e._v(" "),t.action_info.is("preview")?i("material-file-preview",{attrs:{file:t}}):e._e()],1)})),0)])],2)}),[],!1,null,null,null).exports,_=i(1845),m=i(839),v={name:"material-client-root",components:{StepElementHeading:_.a,MaterialClientDetail:u},props:{material:{required:!0,type:a.a},step_element:{required:!0,type:m.a}}},p=Object(l.a)(v,(function(){var e=this.$createElement,t=this._self._c||e;return this.material?t("div",{staticClass:"shp-clear"},[t("div",{staticClass:"m-b-xl"},[t("step-element-heading",{attrs:{step_element:this.step_element}},[t("template",{slot:"name_prefix"},[this._t("name_prefix")],2)],2),this._v(" "),t("material-client-detail",{attrs:{material:this.material}})],1)]):this._e()}),[],!1,null,null,null);t.default=p.exports}}]);
//# sourceMappingURL=59.59.887b0bbc8e584ac13eff.js.map