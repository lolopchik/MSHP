(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{1883:function(t,i,r){"use strict";r.d(i,"a",(function(){return R})),r.d(i,"b",(function(){return get_answer_uid})),r.d(i,"c",(function(){return have_answers}));r(26),r(70),r(82),r(41),r(88),r(29),r(53),r(36),r(116),r(117);var a,o=r(34),u=r.n(o),l=r(4),c=r.n(l),_=r(5),p=r.n(_),d=r(14),m=r.n(d),h=r(15),v=r.n(h),g=r(8),w=r.n(g),b=r(9),q=r.n(b),y=r(20),x=r.n(y),$=(r(11),r(7),r(12),r(43),r(65),r(25),r(23),r(31),r(1)),k=r(370),C=r.n(k),O=r(16),j=r(887),E=r(18),A=r(757),S=r.n(A);function _createForOfIteratorHelper(t,i){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function _unsupportedIterableToArray(t,i){if(!t)return;if("string"==typeof t)return _arrayLikeToArray(t,i);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray(t,i)}(t))||i&&t&&"number"==typeof t.length){r&&(t=r);var a=0,o=function F(){};return{s:o,n:function n(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function e(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var u,l=!0,c=!1;return{s:function s(){r=r.call(t)},n:function n(){var t=r.next();return l=t.done,t},e:function e(t){c=!0,u=t},f:function f(){try{l||null==r.return||r.return()}finally{if(c)throw u}}}}function _arrayLikeToArray(t,i){(null==i||i>t.length)&&(i=t.length);for(var r=0,a=new Array(i);r<i;r++)a[r]=t[r];return a}function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var r,a=w()(t);if(i){var o=w()(this).constructor;r=Reflect.construct(a,arguments,o)}else r=a.apply(this,arguments);return v()(this,r)}}var R=(a=function(t){m()(AttemptAnswerOperator,t);var i,r=_createSuper(AttemptAnswerOperator);function AttemptAnswerOperator(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object($.isRequired)(),a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object($.isRequired)(),o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object($.isRequired)();return c()(this,AttemptAnswerOperator),(t=r.call(this)).state=i,t.attempt=a,t.attempt_id=t.attempt.values.id,t.question_input=o,t.uid=get_answer_uid(a.values.id,o.values.id),t._on_answer=void 0,t.debounced_submit_variant=S()(t.submit_variant,500),t.debounced_submit_variants=S()(t.submit_variants,500),t}return p()(AttemptAnswerOperator,[{key:"on_answer",value:function on_answer(t){return this._on_answer=t,this}},{key:"answers",get:function get(){var t=this.state.models.testing_attempts[this.attempt_id].question_answers||[],i=this.state;return t.map((function(t){return i.models.question_answers[t]&&new j.a(i.models.question_answers[t],i)}))}},{key:"error",get:function get(){return this.state.errors.messages[this.uid]}},{key:"have_answers",get:function get(){return Boolean(!this.question_input.values.required||this.get_input_answer(this.question_input.values.id))}},{key:"get_input_answer",value:function get_input_answer(t){return this.answers.find((function(i){return i.values.input_id===t}))}},{key:"get_variant",value:function get_variant(){var t="",i=this.get_input_answer(this.question_input.values.id);return i&&(t=i.values.variant_id),t}},{key:"get_variants",value:function get_variants(){var t=this;return this.answers.filter((function(i){return i.values.input_id===t.question_input.values.id})).map((function(t){return t.values.variant_id}))}},{key:"get_answer",value:function get_answer(){var t="",i=this.get_input_answer(this.question_input.values.id);return i&&(t=i.values.answer),t}},{key:"submit_variant",value:function submit_variant(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object($.isRequired)(),i=(arguments.length>1&&void 0!==arguments[1]||Object($.isRequired)(),arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object($.isRequired)());t.dispatch("attempts/create_variant",{$store:t,uid:this.uid,attempt_id:this.attempt.values.id,variant_id:i})}},{key:"remove_variant",value:function remove_variant(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object($.isRequired)(),i=(arguments.length>1&&void 0!==arguments[1]||Object($.isRequired)(),arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object($.isRequired)()),r=this.answers.find((function(t){return t.values.variant_id===i}));r&&(r=r.values.id),t.dispatch("attempts/remove_variant",{$store:t,uid:this.uid,attempt_id:this.attempt.values.id,variant_id:i,answer_id:r})}},{key:"submit_variants",value:(i=u()(x.a.mark((function _callee(){var t,i,r,a,o,u,l,c,_,p,d,m,h=arguments;return x.a.wrap((function _callee$(v){for(;;)switch(v.prev=v.next){case 0:t=h.length>0&&void 0!==h[0]?h[0]:Object($.isRequired)(),i=h.length>1&&void 0!==h[1]?h[1]:Object($.isRequired)(),r=h.length>2&&void 0!==h[2]?h[2]:Object($.isRequired)(),a=h.length>3&&void 0!==h[3]?h[3]:Object($.isRequired)(),o=C()(a,r),u=C()(r,a),l=_createForOfIteratorHelper(u);try{for(l.s();!(c=l.n()).done;)_=c.value,this.submit_variant(t,i,_)}catch(t){l.e(t)}finally{l.f()}p=_createForOfIteratorHelper(o);try{for(p.s();!(d=p.n()).done;)m=d.value,this.remove_variant(t,i,m)}catch(t){p.e(t)}finally{p.f()}this._on_answer(r);case 11:case"end":return v.stop()}}),_callee,this)}))),function submit_variants(){return i.apply(this,arguments)})}]),AttemptAnswerOperator}(O.c),q()(a.prototype,"answers",[E.a],Object.getOwnPropertyDescriptor(a.prototype,"answers"),a.prototype),a);function get_answer_uid(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object($.isRequired)(),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object($.isRequired)();return"attempts:".concat(t,":input:").concat(i)}function have_answers(t,i,r){if(!r.values.required)return!0;var a=(t.models.testing_attempts[i].question_answers||[]).map((function(i){return t.models.question_answers[i]&&new j.a(t.models.question_answers[i],t)}));return Boolean(a.find((function(t){return t.values.input_id===r.values.id})))}},1893:function(t,i,r){"use strict";r.d(i,"b",(function(){return selected_user})),r.d(i,"a",(function(){return get_current_unit_user}));r(65),r(7),r(153);var a=r(48),o=r(1),u=r(1617);function selected_user(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(o.isRequired)(),r=t.state.models.classes_selected_users,u=r&&r[i];return u&&t.state.models.users[u.user_id]?new a.a(t.state.models.users[u.user_id],t.state):null}function get_current_unit_user(t){if(t.login.user_data.is_client){var i=t.login.user_data.id,r=Object.values(t.models.unit_users).find((function(t){return t.user_id===i}));return r&&new u.a(r,t)}}},1972:function(t,i,r){},2103:function(t,i,r){"use strict";var a={name:"question-list-row"},o=r(3),u=Object(o.a)(a,(function(){var t=this,i=t.$createElement,r=t._self._c||i;return r("div",{staticClass:"flex flex-stretch m-b no-top"},[r("div",{staticClass:"col-xs-1 text-center col-xs-no-padding",on:{click:function(i){return t.$emit("prev")}}}),t._v(" "),r("div",{staticClass:"col-xs-10"},[t._t("default")],2),t._v(" "),r("div",{staticClass:"col-xs-1 text-center col-xs-no-padding",on:{click:function(i){return t.$emit("next")}}})])}),[],!1,null,null,null);i.a=u.exports},2108:function(t,i,r){"use strict";var a=r(651),o=r.n(a),u=r(842),l=r(1883),c=r(843),_=r(1623);r(1650);var p={name:"report-variant-input",props:{question_input:{type:u.b,required:!0},attempt:{type:c.a,required:!1}},components:{HighlightTex:_.a,PrettyRadio:o.a},data:function data(){return{answer_operator:this.attempt&&new l.a(this.$store.state,this.attempt,this.question_input),force_color:!this.$store.state.login.user_data.is_client}}},d=r(3),m=Object(d.a)(p,(function(){var t=this,i=t.$createElement,r=t._self._c||i;return r("div",{key:t.question_input.id},[t._l(t.question_input.question_variants,(function(i){return r("div",{key:i.values.id,staticClass:"flex"},[r("div",{staticClass:"m-r-xs"},[t.attempt?r("pretty-radio",{staticClass:"inline-block pretty p-round testing-pretty",class:i.values.id===t.answer_operator.get_variant()?"p-default":"p-default-o",attrs:{name:i.uid,color:i.attempt_color(t.attempt,t.force_color),checked:!0}}):r("pretty-radio",{staticClass:"inline-block pretty p-default p-round testing-pretty",attrs:{name:i.uid,color:i.color,checked:!0,disabled:!0}})],1),t._v(" "),r("highlight-tex",{staticClass:"inline-block",attrs:{enable:"tex"===i.values.type||i.values.mathjax_enabled}},[r("div",{staticClass:"field_pretty_radio__text",domProps:{innerHTML:t._s(i.values.rendered_content)}})])],1)})),t._v(" "),t.question_input.question_variants.length?t._e():r("div",{staticClass:"text-danger more-info"},[t._v("\n    "+t._s(t.$gettext("Нет ответов"))+"\n  ")])],2)}),[],!1,null,null,null);i.a=m.exports},2186:function(t,i,r){"use strict";r(25),r(7),r(11),r(12),r(28);var a=r(622),o=r(330),u=r(843),l=r(862),c=r(0),_=r(39),p=r(24),d=r(131),m=r(154),h=[["best",Object(c.$gettext)("Лучшая")],["current",Object(c.$gettext)("Текущая")],["all",Object(c.$gettext)("Все")]];var v=r(1631),g=r(1617),w=r(143),b=r(840),q=r(467),y=r(80),x=r(10),$=r.n(x),k=(r(43),r(31),r(40));var C={name:"testing-not-finished-list",components:{ListFetcher:y.a,ShpFilterString:b.a,TableHeader:w.a},props:{testing:{type:a.b,required:!0},show_unfinished:{type:Boolean,required:!0},user_id:{required:!1}},data:function data(){var t=this.testing.uid+"not_finished",i=function get_testing_attempt_not_finished_table(t){var i=[new k.b("user",Object(c.$gettext)("Участник")),new k.b("status",Object(c.$gettext)("Статус")).center()],r=(new k.c).add_columns(i);return new k.a(t+":columns",r).defaultOrder("user")}(t);return{form:Object(q.a)(this.$store,t),applied_columns:i,UnitUserData:g.a,unit_user_model:v.a}},computed:{filter:function filter(){return this.$store.state.shp_filters[this.form.uid]},filters:function filters(){return[this.applied_columns,{applied:this.filter.result}]},is_preview_mode:function is_preview_mode(){return!this.$store.state.result.is_preview_mode}}},O=r(3),j=Object(O.a)(C,(function(){var t=this,i=t.$createElement,r=t._self._c||i;return r("div",[r("div",{staticClass:"shp-form-inline"},[r("div",{staticClass:"form-group h4 flex-1"},[t._v(t._s(t.$gettext("Нет результатов")))]),t._v(" "),r("ShpFilterString",{staticClass:"form-group",attrs:{apply_btn:!0,clear_btn:!0,group:t.form.uid,name:"query"}})],1),t._v(" "),r("ListFetcher",{attrs:{url:"api:testing_not_finished_list_api",model:t.unit_user_model,data_presenter:t.UnitUserData,limit:25,params:[t.testing.values.id],filters:t.filters},scopedSlots:t._u([{key:"default",fn:function(i){var a=i.data;return[r("div",{staticClass:"table-responsive m-b"},[r("table",{staticClass:"table table-striped table-hover table-bordered"},[r("thead",[r("table-header",{attrs:{table_columns:t.applied_columns}})],1),t._v(" "),r("tbody",t._l(a,(function(i){return r("tr",{key:i.values.id},[r("td",[t._v("\n            "+t._s(i.user.initials)+"\n          ")]),t._v(" "),r("td",{staticClass:"text-center",class:i.reason_background},[t._v("\n            "+t._s(i.reason_display)+"\n          ")])])})),0)])])]}}])})],1)}),[],!1,null,null,null).exports,E=r(97),A=r(22),S=r(2419),R=r(2418),I=r(2344),T=r(21),P=r(63),Q={name:"testing-attempt-standing",components:{AlertError:P.a,TestingAttemptPassing:I.a,TestingAttemptSecondHeading:R.a,TestingAttemptSelect:S.a},props:{testing:{required:!0,type:a.b},attempt:{required:!0,type:u.a}},computed:{prev_attempt:function prev_attempt(){return this.prev_attempt_data.ids.length?o.a.get_instance(this.$store,u.a,this.prev_attempt_data.ids[0]):null},selected_attempt:function selected_attempt(){return this.prev_attempt||this.attempt}},data:function data(){var t=new E.c(A.b["api:testing_attempt_extended_list_api"](),o.a);return{show_history:!1,prev_attempt_data:new E.a("attempt:last:".concat(this.testing.values.id),t).add_query_filter({testing_id:this.testing.values.id,user_id:this.attempt.values.user_id,orderBy:"-number"}).set_limit(1),select_data:new u.b(this.testing.values.id,this.$store.state)}},beforeDestroy:function beforeDestroy(){this.prev_attempt_data.destroy(this.$store)},methods:{set_previous:function set_previous(t){this.prev_attempt_data.query_filter.id=t,this.prev_attempt_data.fetch(this.$store)},remove:function remove(){var t=this;new T.a(A.b["api:testing_attempt_delete_api"](this.selected_attempt.values.id),this.selected_attempt.uid).on_before(T.c.hide_errors(this.selected_attempt.uid)).on_error(T.c.show_errors(this.selected_attempt.uid)).on_success(T.c.remove_instance(this.selected_attempt.values.id,o.a)).on_success((function(){t.$emit("remove")})).execute(this.$store,{})}}},D=Object(O.a)(Q,(function(){var t=this,i=t.$createElement,r=t._self._c||i;return r("div",[t.select_data.action_info.is_edit?r("testing-attempt-select",{attrs:{testing:t.testing,current_id:t.selected_attempt&&t.selected_attempt.values.id,user_id:t.attempt.values.user_id,unit:t.attempt.unit},on:{open:t.set_previous}}):t._e(),t._v(" "),r("div",{staticClass:"panel panel-default"},[r("testing-attempt-second-heading",{attrs:{testing:t.testing,attempt:t.selected_attempt,last_attempt:t.selected_attempt,show_other:!0}},[t.selected_attempt.action_info.is_detail?r("template",{slot:"heading_buttons"},[r("a",{staticClass:"btn btn-inverse btn-sm",on:{click:function(i){return t.selected_attempt.action_operator.remove(t.$store)}}},[r("i",{staticClass:"icon-trash"})])]):t._e()],2),t._v(" "),t.selected_attempt.action_info.is_detail?r("div",{class:{"panel-background":!t.$yandex}},[r("alert-error",{attrs:{uid:t.selected_attempt.uid}}),t._v(" "),r("testing-attempt-passing",{class:{testing_panel__display_list:t.testing.is_display_list},attrs:{testing:t.testing,testing_attempt:t.selected_attempt,show_results:!0}})],1):t._e(),t._v(" "),t.selected_attempt.action_info.is_remove?[r("div",{class:{"panel-body":!t.$yandex}},[r("alert-error",{attrs:{uid:t.selected_attempt.uid}},[r("template",{slot:"no-errors"},[r("h4",{staticClass:"text-danger"},[t._v(t._s(t.$gettext("Вы уверены, что хотите удалить попытку прохождения?")))]),t._v("\n            "+t._s(t.$gettext("Будут удалены ответы и баллы за них"))+"\n          ")])],2)],1),t._v(" "),r("div",{staticClass:"panel-footer"},[r("div",{staticClass:"form-actions"},[r("a",{staticClass:"btn btn-inverse",class:t.selected_attempt.action_info.disabled_dict,on:{click:t.remove}},[r("i",{staticClass:"icon-trash"}),t._v(" "+t._s(t.$gettext("Удалить")))]),t._v(" "),r("a",{staticClass:"btn btn-default pull-right",class:t.selected_attempt.action_info.disabled_dict,on:{click:function(i){return t.selected_attempt.action_operator.detail(t.$store)}}},[r("i",{staticClass:"icon-undo"}),t._v(" "+t._s(t.$gettext("Назад")))])])])]:t._e()],2)],1)}),[],!1,null,null,null).exports,M=r(209),H=r(34),L=r.n(H),B=r(20),N=r.n(B),V=(r(41),r(105),{name:"question-score-cell",functional:!0}),z=Object(O.a)(V,(function(t,i){var r=i._c;return i.props.question_scoring?r("td",{staticClass:"text-center",class:i.props.question_scoring.background_color},[i.props.question_scoring.has_answers()?[i._v(i._s(i.props.question_scoring.score.pretty_format(2)))]:i._e()],2):r("td",[i._v("\n  ???\n")])}),[],!0,null,null,null).exports,W={name:"testing-standing",components:{AlertError:P.a,TableHeader:w.a,QuestionScoreCell:z},props:{testing:{type:a.b,required:!0},attempts:{type:Array,required:!0},list:{type:E.a,required:!0},applied_columns:{required:!0,type:k.a}},computed:{attempt_scores:function attempt_scores(){var t=this,i={};return this.attempts.forEach((function(r){i[r.values.id]=new l.a(t.$store.state,r)})),i},attempt_uid:function attempt_uid(){return this.list.name+":attempt"},max_result_attempt:function max_result_attempt(){if(this.attempts)return $()(this.attempts).sort((function(t,i){return t.total_score-i.total_score}))[0]}},methods:{rewind:function rewind(t){new T.a(A.b["api:testing_attempt_rewind_api"](t.values.id),this.attempt_uid).on_success(T.c.update_instance(o.a)).on_before(T.c.hide_errors(this.attempt_uid)).on_error(T.c.show_errors(this.attempt_uid)).execute(this.$store,{})},show_answers:function show_answers(t){var i=this;return L()(N.a.mark((function _callee(){return N.a.wrap((function _callee$(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,new T.a(A.b["api:testing_show_answers_api"](t.values.testing_id),i.attempt_uid).on_success(T.c.update_instance(o.a)).on_before(T.c.hide_errors(i.attempt_uid)).on_error(T.c.show_errors(i.attempt_uid)).execute(i.$store,{user:t.values.user_id});case 2:return r.next=4,new T.a(A.b["api:testing_attempt_detail_api"](t.values.id),i.attempt_uid).get().on_success(T.c.update_instance(o.a)).execute(i.$store,{});case 4:case"end":return r.stop()}}),_callee)})))()}}},U={name:"testing-standing-root",components:{TestingStanding:Object(O.a)(W,(function(){var t=this,i=t.$createElement,r=t._self._c||i;return r("div",{staticClass:"scroll-x-auto m-b"},[r("AlertError",{attrs:{uid:t.attempt_uid}}),t._v(" "),r("div",{staticClass:"table-scroll"},[r("table",{staticClass:"table table-striped table-bordered table-condensed table-hover"},[r("thead",[r("table-header",{attrs:{table_columns:t.applied_columns}},[t._l(t.testing.questions,(function(i){return r("template",{slot:i.values.id},[r("popover",{key:i.values.id,attrs:{trigger:"hover",title:t.$gettext("Вопрос №")+i.values.number,gettext:"Вопрос №"}},[r("a",{staticClass:"clickable block"},[t._v("\n                "+t._s(i.values.number)+"\n              ")]),t._v(" "),r("div",{attrs:{slot:"popover"},domProps:{innerHTML:t._s(i.values.rendered_content)},slot:"popover"})])],1)})),t._v(" "),r("template",{slot:t.applied_columns.get_column("is_last").column_config.name+":title"},[r("popover",{attrs:{trigger:"hover",content:t.$gettext("Учащийся может увидеть ответы, но не может повторно пройти тест"),gettext:"Учащийся может увидеть ответы, но не может повторно пройти тест"}},[r("span",[t._v(t._s(t.applied_columns.get_column("is_last").column_config.title))])])],1)],2)],1),t._v(" "),r("tbody",[t._l(t.attempts,(function(i,a){return[r("tr",{key:i.uid,staticClass:"clickable",on:{click:function(r){return t.$emit("open",i)}}},[r("td",[t._v("\n              "+t._s(t.list.paginator.offset+a+1)+".\n              "),r("span",{staticClass:"text-info",class:{"text-muted":!i.user.values.is_client}},[t._v("\n                "+t._s(i.user.initials)+"\n              ")])]),t._v(" "),t._l(t.testing.questions,(function(a){return r("question-score-cell",{key:a.uid,attrs:{question_scoring:t.attempt_scores[i.values.id].get_question_scoring(a)}})})),t._v(" "),r("td",{staticClass:"text-center"},[t._v("\n              "+t._s(i.values.number)+"\n            ")]),t._v(" "),r("td",{staticClass:"text-center"},[i.values.finished_at?r("span",[r("span",[t._v(t._s(t._f("moment")(i.values.finished_at,"DD.MM HH:mm")))]),t._v(" "),r("span",[t._v("\n                  ("+t._s(i.decision_time.asMinutes().toFixed(0))+" "),r("span",[t._v(t._s(t.$gettext("мин")))]),t._v(")\n                ")])]):r("span",[t._v("-")])]),t._v(" "),r("td",{staticClass:"text-center",class:i.color+"-background"},[t._v("\n              "+t._s(i.values.score)+"\n            ")]),t._v(" "),r("td",{staticClass:"text-center",class:i.color+"-background"},[t._v("\n              "+t._s(i.values.percent)+"\n            ")]),t._v(" "),r("td",{staticClass:"text-center"},[i.values.is_finished?i.values.is_passed?r("span",{staticClass:"text-success text-center"},[t._v("\n                "+t._s(t.$gettext("Да"))+"\n              ")]):r("span",{staticClass:"text-danger text-center"},[t._v("\n                "+t._s(t.$gettext("Нет"))+"\n              ")]):r("span",{staticClass:"text-warning text-center"},[t._v("\n                "+t._s(t.$gettext("Текущая"))+"\n              ")])]),t._v(" "),i.values.is_last?r("td",{staticClass:"text-center",class:{clickable:!i.is_testing_finished},on:{click:function(r){r.stopPropagation(),!i.is_testing_finished&&t.rewind(i)}}},[r("i",{directives:[{name:"tooltip",rawName:"v-tooltip",value:i.is_testing_finished?t.$gettext("Тестирование завершено"):"",expression:"attempt.is_testing_finished ? $gettext('Тестирование завершено'):''"}],staticClass:"icon-ok",class:{"text-muted":i.is_testing_finished},attrs:{gettext:"Тестирование завершено"}})]):r("td",{staticClass:"text-center clickable",on:{click:function(r){r.stopPropagation(),!i.values.is_last&&t.show_answers(i)}}})],2)]}))],2),t._v(" "),r("tfoot",[r("tr",[r("td",{staticClass:"nowrap sticky text-info text-right more-info bold"},[t._v("\n              "+t._s(t.$gettext("Максимальный возможный балл:"))+"\n          ")]),t._v(" "),t._l(t.testing.questions,(function(i){return r("td",{key:i.values.id,staticClass:"text-center"},[t._v("\n              "+t._s(i.values.score)+"\n          ")])}))],2)])])])],1)}),[],!1,null,null,null).exports,ShpFilterFormField:M.a,ShpFilterString:b.a,ListFetcher:y.a,AlertError:P.a,TestingAttemptStanding:D,TestingNotFinishedList:j},props:{testing:{type:a.b,required:!0},user_id:{required:!1}},data:function data(){var t=this.testing.uid+"standing",i=function get_testing_standing_filters(t,i){var r=new _.a(i,[new p.a("query","").text_input(),new p.a("is_best",Object(c.$gettext)("Попытка")).select().choices(h)]);return new m.a(r).create(t),new d.a("is_best","select").immediate().default("best").adapter((function(t,i){"best"===i.value?t.is_best=!0:"current"===i.value&&(t.is_current=!0)})).add(t,i),r}(this.$store,t+":filters");return{namespace:t,applied_columns:function get_testing_standing_table(t,i){var r=t.questions.map((function(t){return new k.b(t.values.id,t.values.number).center()})),a=[new k.b("user",Object(c.$gettext)("Участники")+" \\ "+Object(c.$gettext)("Вопросы")).sortable()].concat($()(r),[new k.b("number",Object(c.$gettext)("Попытка №")).sortable().center(),new k.b("сlose_date",Object(c.$gettext)("Время завершения")).sortable().center(),new k.b("score",Object(c.$gettext)("Баллов")).sortable().center(),new k.b("percent",Object(c.$gettext)("Процент")).sortable().center(),new k.b("is_passed",Object(c.$gettext)("Успешно?")).sortable().center(),new k.b("is_last",Object(c.$gettext)("Завершено")).sortable().center()]);return new k.a(i+":columns",(new k.c).add_columns(a)).defaultOrder("-score, user")}(this.testing,this.namespace),selected_attempt:null,testing_attempt_model:o.a,form:i,TestingAttemptData:u.a,fetch_key:0}},computed:{filter:function filter(){return this.$store.state.shp_filters[this.form.uid]},is_preview_mode:function is_preview_mode(){return this.$store.state.result.is_preview_mode},query_filter:function query_filter(){var t=this.is_preview_mode?{applied:{user_id:this.user_id}}:{};return[this.applied_columns,{applied:this.filter.result},{applied:{testing_id:this.testing.values.id}},t]},attempt_scores:function attempt_scores(){var t=this,i={};return this.attempts.forEach((function(r){i[r.values.id]=new l.a(t.$store.state,r)})),i},attempt_uid:function attempt_uid(){return this.testing.uid+":attempt"}},methods:{close_attempt:function close_attempt(){this.selected_attempt=null,this.fetch_key++},open_attempt:function open_attempt(t){this.selected_attempt=t}}},J=Object(O.a)(U,(function(){var t=this,i=t.$createElement,r=t._self._c||i;return r("div",[r("alert-error",{attrs:{uid:t.attempt_uid}}),t._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:!t.$store.state.result.is_preview_mode,expression:"!$store.state.result.is_preview_mode"}],staticClass:"shp-form-inline"},[r("div",{staticClass:"h4 form-group flex-1"},[t._v("\n      "+t._s(t.$gettext("Результаты тестирования"))+"\n    ")]),t._v(" "),r("ShpFilterFormField",t._b({staticClass:"form-group",attrs:{form:t.form}},"ShpFilterFormField",t.form.get_props("is_best"),!1)),t._v(" "),r("ShpFilterString",{staticClass:"form-group",attrs:{apply_btn:!0,clear_btn:!0,group:t.form.uid,name:"query"}})],1),t._v(" "),t.filter.iteration>0?r("ListFetcher",{attrs:{url:"api:testing_attempt_extended_list_api",model:t.testing_attempt_model,filters:t.query_filter,limit:25,data_presenter:t.TestingAttemptData,use_default_paginator:!t.is_preview_mode},scopedSlots:t._u([{key:"default",fn:function(i){var a=i.data,o=i.list;return[r("TestingStanding",{attrs:{attempts:a,list:o,testing:t.testing,applied_columns:t.applied_columns},on:{open:t.open_attempt}})]}}],null,!1,1073080106)}):t._e(),t._v(" "),t.$store.state.result.is_preview_mode?t._e():r("testing-not-finished-list",{attrs:{testing:t.testing,show_unfinished:!0,user_id:t.user_id}}),t._v(" "),t.$store.state.result.is_preview_mode?t._e():r("modal",{staticClass:"modal-extra-large",attrs:{value:Boolean(t.selected_attempt),title:t.selected_attempt&&t.selected_attempt.user.initials,footer:!1},on:{input:t.close_attempt,hide:t.close_attempt}},[t.selected_attempt?r("testing-attempt-standing",{attrs:{testing:t.testing,attempt:t.selected_attempt},on:{remove:t.close_attempt}}):t._e()],1)],1)}),[],!1,null,null,null);i.a=J.exports},2278:function(t,i,r){"use strict";r(68);var a=r(622),o=r(2281),u=r(89),l={name:"TestingQuestionLayout",components:{QuestionCard:o.a},props:{testing:{type:a.b,required:!0},checked:{type:u.b,required:!0}},data:function data(){return{current_question_id:Number(this.checked.get_opened_id())}},watch:{"checked.opened":function checkedOpened(){this.current_question_id=Number(this.checked.get_opened_id())}}},c=r(3),_=Object(c.a)(l,(function(){var t=this,i=t.$createElement,r=t._self._c||i;return r("div",[t.testing.is_display_list?[t._t("default")]:r("QuestionCard",{attrs:{questions:t.testing.questions,current_question_id:t.current_question_id},on:{next:function(i){return t.checked.next()},prev:function(i){return t.checked.prev()}}},[t._t("default")],2)],2)}),[],!1,null,null,null);i.a=_.exports},2281:function(t,i,r){"use strict";r(68),r(272),r(11),r(7),r(12);var a=r(27),o=r(847),u={name:"QuestionCard",props:{questions:{required:!1,type:Array,validator:Object(a.a)(o.b)},current_question_id:{required:!1,type:Number}},computed:{show_roulette:function show_roulette(){return!this.questions||this.questions&&this.questions.length>1},first_question:function first_question(){var t=this;return this.questions&&!this.questions.findIndex((function(i){return i.values.id===t.current_question_id}))},last_question:function last_question(){var t=this;return this.questions&&this.questions.findIndex((function(i){return i.values.id===t.current_question_id}))===this.questions.length-1}}},l=r(3),c=Object(l.a)(u,(function(){var t=this,i=t.$createElement,r=t._self._c||i;return r("div",{staticClass:"flex flex-stretch"},[!t.first_question||t.show_roulette?r("div",{staticClass:"btn-default col-xs-1 flex flex-vertical-center flex-center btn panel-default",class:{disabled:t.first_question},attrs:{tabindex:"100"},on:{click:function(i){!t.first_question&&t.$emit("prev")},keyup:function(i){return!i.type.indexOf("key")&&t._k(i.keyCode,"enter",13,i.key,"Enter")?null:t.$emit("prev")}}},[t._t("prev",(function(){return[t._m(0)]}))],2):r("div",{staticClass:"col-xs-1 flex flex-vertical-center flex-center",attrs:{tabindex:"100"}}),t._v(" "),r("div",{staticClass:"col-xs-10"},[t._t("default")],2),t._v(" "),!t.last_question||t.show_roulette?r("div",{staticClass:"btn-default col-xs-1 flex flex-vertical-center flex-center btn panel-default",class:{disabled:t.last_question},attrs:{tabindex:"101"},on:{click:function(i){!t.last_question&&t.$emit("next")},keyup:function(i){return!i.type.indexOf("key")&&t._k(i.keyCode,"enter",13,i.key,"Enter")?null:t.$emit("next")}}},[t._t("next",(function(){return[t._m(1)]}))],2):r("div",{staticClass:"col-xs-1 flex flex-vertical-center flex-center",attrs:{tabindex:"101"}})])}),[function(){var t=this.$createElement,i=this._self._c||t;return i("a",{staticClass:"inline-block lead no-bottom"},[i("i",{staticClass:"icon-chevron-left"})])},function(){var t=this.$createElement,i=this._self._c||t;return i("a",{staticClass:"inline-block lead no-bottom"},[i("i",{staticClass:"icon-chevron-right"})])}],!1,null,null,null);i.a=c.exports},2330:function(t,i,r){},2331:function(t,i,r){},2332:function(t,i,r){},2333:function(t,i,r){},2334:function(t,i,r){},2335:function(t,i,r){},2344:function(t,i,r){"use strict";r(11),r(7),r(12),r(25);var a,o=r(622),u=r(843),l=r(89),c=(r(28),r(1675)),_=r(4),p=r.n(_),d=r(5),m=r.n(d),h=r(9),v=r.n(h),g=(r(43),r(65),r(23),r(1)),w=r(1883),b=r(18),q=(a=function(){function AttemptQuestionStatus(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(g.isRequired)(),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(g.isRequired)(),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object(g.isRequired)();p()(this,AttemptQuestionStatus),this.state=t,this.attempt=i,this.question=r}return m()(AttemptQuestionStatus,[{key:"input_answer_operators",get:function get(){var t=this;return this.question.question_inputs.map((function(i){return new w.a(t.state,t.attempt,i)}))}},{key:"error",get:function get(){var t=this.input_answer_operators.find((function(t){return t.error}));return t&&t.error}},{key:"have_answers",get:function get(){return!this.input_answer_operators.find((function(t){return!t.have_answers}))}}]),AttemptQuestionStatus}(),v()(a.prototype,"input_answer_operators",[b.a],Object.getOwnPropertyDescriptor(a.prototype,"input_answer_operators"),a.prototype),a),y=r(2103),x={name:"question-passing-scroll",components:{QuestionListRow:y.a,ListScroll:c.a},props:{testing:{type:o.b,required:!0},testing_attempt:{required:!0,type:u.a},checked:{required:!0,type:l.b}},methods:{set_current:function set_current(t){this.checked.open(t.id)},tooltip:function tooltip(t){return this.question_statuses[t.values.id].error?this.question_statuses[t.values.id].error:this.question_statuses[t.values.id].have_answers?this.$gettext("Ответ принят"):void 0}},computed:{question_statuses:function question_statuses(){var t=this,i={};return this.testing.questions.forEach((function(r){i[r.values.id]=new q(t.$store.state,t.testing_attempt,r)})),i}}},$=(r(2715),r(3)),k=Object($.a)(x,(function(){var t=this,i=t.$createElement,r=t._self._c||i;return r("div",[r("question-list-row",{on:{prev:function(i){return t.$refs.scroll.prev_or_scroll()},next:function(i){return t.$refs.scroll.next_or_scroll()}}},[t.testing.is_multiple_questions?r("list-scroll",{ref:"scroll",staticClass:"questions-list",attrs:{items:t.testing.questions,show_prev:!1,show_next:!1,scroll_classes:"shp-padding-top nowrap"},on:{next:function(i){return t.checked.next()},prev:function(i){return t.checked.prev()}},scopedSlots:t._u([{key:"item",fn:function(i){return r("div",{staticClass:"relative"},[r("div",{staticClass:"inline-block clickable no-bottom",on:{click:function(r){return t.checked.open(i.item.values.id)}}},[r("div",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.tooltip(i.item),expression:"tooltip(slotProps.item)"}],staticClass:"shp-square shp-square-white shp-square-lg monospace-font question_square"},[r("div",{staticClass:"lead inline-block no-bottom"},[t._v(t._s(i.item.values.number))]),t._v(" "),t.question_statuses[i.item.values.id].error?r("div",{staticClass:"question__circle bottom-right-circle"},[r("div",{staticClass:"bg-danger shp-circle shp-circle-lg text-center absolute"},[t._v("!")])]):t.question_statuses[i.item.values.id].have_answers?r("div",{staticClass:"question__circle bottom-right-circle"},[r("div",{staticClass:"bg-info shp-circle shp-circle-lg text-center absolute"},[r("i",{staticClass:"icon-question"})])]):t._e()])])])}}],null,!1,3812370165)}):t._e()],1)],1)}),[],!1,null,null,null).exports,C=r(862),O={name:"question-passing-result-scroll",components:{QuestionListRow:y.a,ListScroll:c.a},props:{questions:{required:!0},testing_attempt:{required:!0,type:u.a},checked:{required:!0,type:l.b},protocol:{required:!1,default:!1}},methods:{set_current:function set_current(t){this.checked.open(t.id)}},computed:{question_scorings:function question_scorings(){var t=this,i={};return this.questions.forEach((function(r){i[r.values.id]=new C.b(t.$store.state,t.testing_attempt,r)})),i}}},j=(r(2716),Object($.a)(O,(function(){var t=this,i=t.$createElement,r=t._self._c||i;return r("question-list-row",{on:{prev:function(i){return t.$refs.scroll.prev_or_scroll()},next:function(i){return t.$refs.scroll.next_or_scroll()}}},[r("list-scroll",{ref:"scroll",staticClass:"questions-list",attrs:{items:t.questions,show_prev:!1,show_next:!1,scroll_classes:"shp-padding-top nowrap"},on:{next:function(i){return t.checked.next()},prev:function(i){return t.checked.prev()}},scopedSlots:t._u([{key:"item",fn:function(i){return r("div",{staticClass:"relative"},[r("div",{staticClass:"inline-block clickable no-bottom",on:{click:function(r){return t.checked.open(i.item.values.id)}}},[r("div",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.question_scorings[i.item.values.id].score_text(t.protocol),expression:"question_scorings[slotProps.item.values.id].score_text(protocol)"}],staticClass:"shp-square shp-square-white shp-square-lg monospace-font question_square"},[r("div",{staticClass:"lead inline-block no-bottom"},[t._v(t._s(i.item.values.number))]),t._v(" "),t.question_scorings[i.item.values.id].show_wrong_answers||t.question_scorings[i.item.values.id].is_checked()&&t.testing_attempt.values.is_last?t.question_scorings[i.item.values.id].is_partial()?r("div",{staticClass:"question__circle bottom-right-circle"},[r("div",{staticClass:"bg-yellow shp-circle shp-circle-lg text-center absolute"},[r("i",{staticClass:"icon-ok"})])]):t.question_scorings[i.item.values.id].is_errors()?r("div",{staticClass:"question__circle bottom-right-circle"},[r("div",{staticClass:"bg-danger shp-circle shp-circle-lg text-center absolute"},[r("i",{staticClass:"icon-remove"})])]):r("div",{staticClass:"question__circle bottom-right-circle"},[r("div",{staticClass:"bg-success shp-circle shp-circle-lg text-center absolute"},[r("i",{staticClass:"icon-ok"})])]):r("div",{staticClass:"question__circle bottom-right-circle"},[r("div",{staticClass:"bg-info shp-circle shp-circle-lg text-center absolute"},[r("i",{staticClass:"icon-question"})])])])])])}}])})],1)}),[],!1,null,null,null).exports),E=(r(31),r(41),r(847)),A=r(842),S={name:"attempt-input-report",props:{input_scoring:{required:!1}},computed:{scoring_tooltip_ok:function scoring_tooltip_ok(){return this.$gettext("Правильный ответ")+"<br>"+this.input_scoring.score.pretty_format(2)+" "+this.$gettext("балл(а)")},scoring_tooltip_no:function scoring_tooltip_no(){return this.$gettext("Неправильный ответ")+"<br>0"+this.$gettext("баллов")},scoring_tooltip_particle:function scoring_tooltip_particle(){return this.$gettext("Частичный ответ")+"<br> "+this.input_scoring.score.pretty_format(2)+" "+this.$gettext("балл(а)")}}},R=Object($.a)(S,(function(){var t=this,i=t.$createElement,r=t._self._c||i;return r("div",{staticStyle:{"align-self":"flex-start"}},[r("div",{staticStyle:{"flex-grow":"8"}},[t._t("default")],2),t._v(" "),r("div",[t.input_scoring?[t.input_scoring.is_checked?t.input_scoring.is_answered?[r("span",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.scoring_tooltip_ok,expression:"scoring_tooltip_ok"}],staticClass:"shp-circle shp-circle-lg bg-success text-center"},[r("i",{staticClass:"icon-ok"})])]:t.input_scoring.is_errors?[r("span",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.scoring_tooltip_no,expression:"scoring_tooltip_no"}],staticClass:"shp-circle shp-circle-lg bg-danger text-center"},[r("i",{staticClass:"icon-remove"})])]:t.input_scoring.is_partial?[r("span",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.scoring_tooltip_particle,expression:"scoring_tooltip_particle"}],staticClass:"shp-circle shp-circle-lg bg-yellow text-center"},[r("i",{staticClass:"icon-ok"})])]:void 0:[r("span",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.$gettext("Находится на проверке"),expression:"$gettext('Находится на проверке')"}],staticClass:"shp-circle shp-circle-lg bg-info text-center",attrs:{gettext:"Находится на проверке"}},[r("i",{staticClass:"icon-question"})])]]:t._e()],2)])}),[],!1,null,null,null).exports,I=r(121),T=r(110),P=r(469),Q=r(144),D={name:"attempt-input-status",props:{operator:{type:w.a,required:!0},formEngine:{required:!0},have_answers:{required:!0,type:Boolean}},computed:{error:function error(){return this.operator.error?Array.isArray(this.operator.error)?this.operator.error[0]:this.operator.error:this.formEngine.errors.length?this.formEngine.errors[0].error:null}}},M=Object($.a)(D,(function(){var t=this,i=t.$createElement,r=t._self._c||i;return r("div",{class:{flex:"custom"===t.operator.question_input.values.widget,"inline-flex":"custom"!==t.operator.question_input.values.widget}},[r("div",{staticStyle:{"flex-grow":"8","overflow-x":"auto"}},[t._t("default")],2),t._v(" "),r("div",{staticClass:"m-l-xs"},[t.operator.action_info.is_pending?[r("i",{staticClass:"h2 no-top no-bottom icon-spinner icon-spin no-padding text-info"})]:t.error?[r("span",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.error,expression:"error"}],staticClass:"shp-circle shp-circle-lg bg-danger text-center"},[r("i",{staticClass:"icon-exclamation"})])]:t.have_answers?[r("span",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.$gettext("Ответ принят"),expression:"$gettext('Ответ принят')"}],staticClass:"shp-circle shp-circle-lg bg-info  text-center",attrs:{gettext:"Ответ принят"}},[r("i",{staticClass:"icon-ok"})])]:t._e()],2)])}),[],!1,null,null,null).exports,H=r(45),L=r(868),B={name:"attempt-textarea",components:{AttemptInputStatus:M,FormField:Q.a,FieldOnlyWrapper:P.a},props:{question_input:{type:A.b,required:!0},attempt:{type:u.a,required:!0}},data:function data(){var t=this,i=new w.a(this.$store.state,this.attempt,this.question_input).on_answer((function(i,r){t.have_answers=!0,t.answer_id=r.data.id})),r=new T.a("answer","textArea").placeholder(this.$gettext("Укажите свой ответ")).add_options({fieldClasses:"no-resize",autocomplete:"off"}).disabled_when((function(){return t.attempt.is_finished}));1===this.question_input.values.number&&r.set_focus();var a="".concat(this.question_input.values.id,"|").concat(this.attempt.values.id);return{answer_key:a,answer_operator:i,formEngine:new I.a(this,i.uid).no_field_errors().with_fields([r]).on_change((function(i){t.formEngine.hide_errors(t.$store),t.$store.commit("attempts/wait_send");var r={attempt_id:t.attempt.values.id,id:a,answer:i};(new H.d).insert(t.$store,L.a,{result:r})})),model:{answer:i.get_answer()}}},mounted:function mounted(){this.formEngine.call_field_component("answer",(function(t){Object(b.l)(t.$el)}))},computed:{have_answers:function have_answers(){var t=this.$store.state.models.input_answers,i=t&&t[this.answer_key];return Boolean(this.answer_operator.have_answers)||Boolean(i)}}},N=Object($.a)(B,(function(){var t=this,i=t.$createElement,r=t._self._c||i;return r("attempt-input-status",{class:t.question_input.css_classes,attrs:{operator:t.answer_operator,formEngine:t.formEngine,have_answers:t.have_answers}},[r("div",{staticClass:"no-any-bottom"},[t._l(t.formEngine.fields,(function(i){return[r("field-only-wrapper",{key:i.name,attrs:{field:i,model:t.model,formEngine:t.formEngine}},[r("form-field",{attrs:{field:i,model:t.model,formEngine:t.formEngine}})],1)]}))],2)])}),[],!1,null,null,null).exports,V={name:"attempt-input",components:{AttemptInputStatus:M,FormField:Q.a,FieldOnlyWrapper:P.a},props:{question_input:{type:A.b,required:!0},attempt:{type:u.a,required:!0}},data:function data(){var t=this;console.log("AttemptInput created");var i=this.attempt,r=this.question_input,a=new w.a(this.$store.state,i,r),o=new T.a("answer","input2").max_length(r.max_length).placeholder(this.$gettext("Укажите свой ответ")).disabled_when((function(){return i.values.is_finished||(t.$store.state.login.user_data.is_pupil||t.$store.state.login.user_data.is_client)&&i.is_finished})).add_options({autocomplete:"off",inputType:r.type,alphabet:r.values.alphabet,case_sensitive:r.values.case_sensitive});1===r.values.number&&o.set_focus();var u="".concat(this.question_input.values.id,"|").concat(this.attempt.values.id);return{answer_key:u,answer_operator:a,formEngine:new I.a(this,a.uid).no_field_errors().with_fields([o]).on_change((function(i){t.formEngine.hide_errors(t.$store),t.$store.commit("attempts/wait_send");var r={attempt_id:t.attempt.values.id,id:u,answer:i};(new H.d).insert(t.$store,L.a,{result:r})})),model:{answer:a.get_answer()}}},computed:{have_answers:function have_answers(){var t="".concat(this.question_input.values.id,"|").concat(this.attempt.values.id),i=this.$store.state.models.input_answers,r=i&&i[t];return Boolean(this.answer_operator.have_answers)||Boolean(r)}}},z=Object($.a)(V,(function(){var t=this,i=t.$createElement,r=t._self._c||i;return r("attempt-input-status",{class:t.question_input.css_classes,attrs:{operator:t.answer_operator,formEngine:t.formEngine,have_answers:t.have_answers}},[r("div",{staticClass:"no-any-bottom no-bottom"},[t._l(t.formEngine.fields,(function(i){return[r("field-only-wrapper",{key:i.name,attrs:{field:i,model:t.model,formEngine:t.formEngine}},[r("form-field",{attrs:{field:i,model:t.model,formEngine:t.formEngine}})],1)]}))],2)])}),[],!1,null,null,null).exports,W={name:"attempt-select",components:{AttemptInputStatus:M,FormField:Q.a,FieldOnlyWrapper:P.a},props:{question_input:{type:A.b,required:!0},attempt:{type:u.a,required:!0}},data:function data(){var t=this,i=new w.a(this.$store.state,this.attempt,this.question_input);return{answer_operator:i,formEngine:new I.a(this,i.uid).no_field_errors().with_fields([new T.a("answer","button-select").max_length(this.question_input.max_length).choices(this.question_input.question_variants.map((function(t){return[t.values.id,t.values.rendered_content]}))).placeholder(this.$gettext("Укажите ответ")).disabled_when((function(){return t.attempt.is_finished})).add_options({styleClasses:"full-width"})]).on_change((function(i){t.formEngine.hide_errors(t.$store),t.submit_answer(i)})),model:{answer:i.get_variant()}}},methods:{submit_answer:function submit_answer(t){this.answer_operator.debounced_submit_variant(this.$store,this.formEngine,t)}},computed:{have_answers:function have_answers(){return Object(w.c)(this.$store.state,this.attempt.values.id,this.question_input)}}},U=Object($.a)(W,(function(){var t=this,i=t.$createElement,r=t._self._c||i;return r("attempt-input-status",{class:t.question_input.css_classes,attrs:{operator:t.answer_operator,formEngine:t.formEngine,have_answers:t.have_answers}},[r("div",{staticClass:"to-top no-any-bottom"},[t._l(t.formEngine.fields,(function(i){return[r("field-only-wrapper",{key:i.value,attrs:{field:i,model:t.model,formEngine:t.formEngine}},[r("form-field",{attrs:{field:i,model:t.model,formEngine:t.formEngine}})],1)]}))],2)])}),[],!1,null,null,null).exports;r(1972);var J={name:"attempt-variant-input",components:{AttemptInputStatus:M,FormField:Q.a,FieldOnlyWrapper:P.a},props:{question_input:{type:A.b,required:!0},attempt:{type:u.a,required:!0}},data:function data(){var t=this,i=new w.a(this.$store.state,this.attempt,this.question_input);return{answer_operator:i,formEngine:new I.a(this,i.uid).no_field_errors().with_fields([new T.a("answer").radio("pretty-radio").max_length(this.question_input.max_length).choices(this.question_input.question_variants.map((function(t){return[t.values.id,t.values.rendered_content]}))).disabled_when((function(){return t.attempt.is_finished})).add_options({fieldClasses:"m-b-sm"})]).on_change((function(i){t.formEngine.hide_errors(t.$store),t.submit_answer(i)})),model:{answer:i.get_variant()}}},methods:{submit_answer:function submit_answer(t){this.answer_operator.debounced_submit_variant(this.$store,this.formEngine,t)}},computed:{have_answers:function have_answers(){return Object(w.c)(this.$store.state,this.attempt.values.id,this.question_input)}}},X=(r(2717),Object($.a)(J,(function(){var t=this,i=t.$createElement,r=t._self._c||i;return r("attempt-input-status",{class:t.question_input.css_classes,attrs:{operator:t.answer_operator,formEngine:t.formEngine,have_answers:t.have_answers}},[r("div",{staticClass:"to-top pretty p-default p-round testing-pretty attempt_variant_input__wrap",staticStyle:{"white-space":"normal"}},[t._l(t.formEngine.fields,(function(i){return[r("field-only-wrapper",{key:i.name,attrs:{field:i,model:t.model,formEngine:t.formEngine}},[r("form-field",{attrs:{field:i,model:t.model,formEngine:t.formEngine}})],1)]}))],2)])}),[],!1,null,null,null).exports),G={name:"attempt-multiple-variant-input",components:{AttemptInputStatus:M,FormField:Q.a,FieldOnlyWrapper:P.a},props:{question_input:{type:A.b,required:!0},attempt:{type:u.a,required:!0}},data:function data(){var t=this,i=new w.a(this.$store.state,this.attempt,this.question_input).on_answer((function(i){t.last_answer=i}));return{answer_operator:i,formEngine:new I.a(this,i.uid).no_field_errors().with_fields([new T.a("answer").radio("pretty-checkbox-list").max_length(this.question_input.max_length).choices(this.question_input.question_variants.map((function(t){return[t.values.id,t.values.rendered_content]}))).disabled_when((function(){return t.attempt.is_finished}))]).on_change((function(i){t.formEngine.hide_errors(t.$store),t.submit_answer(i)})),model:{answer:i.get_variants()},last_answer:i.get_variants()}},computed:{have_answers:function have_answers(){return Object(w.c)(this.$store.state,this.attempt.values.id,this.question_input)}},methods:{submit_answer:function submit_answer(t){this.answer_operator.debounced_submit_variants(this.$store,this.formEngine,t,this.last_answer)}}},K=(r(2718),Object($.a)(G,(function(){var t=this,i=t.$createElement,r=t._self._c||i;return r("attempt-input-status",{class:t.question_input.css_classes,attrs:{operator:t.answer_operator,formEngine:t.formEngine,have_answers:t.have_answers}},[r("div",{staticClass:"to-top form-group"},[t._l(t.formEngine.fields,(function(i){return[r("field-only-wrapper",{key:i.name,staticClass:"testing-pretty admin_multiple_variant_input__pretty_input",attrs:{field:i,model:t.model,formEngine:t.formEngine}},[r("form-field",{attrs:{field:i,model:t.model,formEngine:t.formEngine}})],1)]}))],2)])}),[],!1,null,null,null).exports),Y=r(2108),Z=r(651),tt=r.n(Z),et=r(635);r(1650);var st={name:"input-report-dropdown",components:{PrettyRadio:tt.a},props:{question_variants:{required:!0},variant_id:{required:!1},attempt:{required:!0}}},nt=(r(2719),Object($.a)(st,(function(){var t=this,i=t.$createElement,r=t._self._c||i;return r("dropdown",{staticClass:"input-group-btn",attrs:{"menu-right":"","append-to-body":""}},[r("btn",{attrs:{type:"white"}},[r("span",{staticClass:"caret"})]),t._v(" "),r("template",{slot:"dropdown"},t._l(t.question_variants,(function(i){return r("li",{key:i.values.id},[r("a",[r("pretty-radio",{staticClass:"inline-block pretty p-round p-bold to-top m-t-xs",class:i.values.id===t.variant_id?"p-default":"p-default-o",attrs:{name:i.uid,color:i.color,checked:!0}}),t._v(" "),r("div",{staticClass:"inline-block pre-input",domProps:{innerHTML:t._s(i.values.rendered_content)}})],1)])})),0)],2)}),[],!1,null,null,null).exports);r(1650);var it={name:"report-select-input",props:{question_input:{type:A.b,required:!0},attempt:{type:u.a,required:!0}},components:{InputReportDropdown:nt,PrettyRadio:tt.a},data:function data(){var t=new w.a(this.$store.state,this.attempt,this.question_input);return{answer_operator:t,variant_id:t.get_variant()}},computed:{current_variant:function current_variant(){var t=this.answer_operator.get_variants();return t.length?new et.b(this.$store.state.models.question_variants[t[0]],this.$store.state):void 0}}},rt=Object($.a)(it,(function(){var t=this,i=t.$createElement,r=t._self._c||i;return r("div",{staticClass:"form-group"},[r("div",{staticClass:"input-group"},[r("span",{staticClass:"input-group-addon overflow-hidden text-left non_editable_div full-width"},[t.current_variant?[t.attempt.is_published?r("pretty-radio",{staticClass:"block pretty p-default p-round p-bold",attrs:{name:t.current_variant.uid+"current",color:t.current_variant.color,checked:!0}},[r("div",{domProps:{innerHTML:t._s(t.current_variant.values.rendered_content)}})]):r("pretty-radio",{staticClass:"block pretty p-default p-round p-bold",attrs:{name:t.current_variant.uid+"current",checked:!0}},[r("div",{domProps:{innerHTML:t._s(t.current_variant.values.rendered_content)}})])]:[t._v(t._s(t.$gettext("Нет ответа")))]],2),t._v(" "),t.attempt.values.is_last?r("input-report-dropdown",{attrs:{question_variants:t.question_input.question_variants,variant_id:t.variant_id,attempt:t.attempt}}):t._e()],1)])}),[],!1,null,null,null).exports,at=r(464),ot=r.n(at);r(1650);var ut={name:"report-multiple-variant-input",components:{PrettyCheckbox:ot.a},props:{question_input:{type:A.b,required:!0},attempt:{type:u.a,required:!0}},data:function data(){return{force_color:!this.$store.state.login.user_data.is_client}},computed:{variants:function variants(){return new w.a(this.$store.state,this.attempt,this.question_input).get_variants()}},methods:{is_selected:function is_selected(t){return this.variants.indexOf(t.values.id)>=0}}},lt=Object($.a)(ut,(function(){var t=this,i=t.$createElement,r=t._self._c||i;return r("div",{staticClass:"form-group"},t._l(t.question_input.question_variants,(function(i){return r("div",{key:i.values.id,staticClass:"flex flex-vertical-baseline"},[t.attempt.values.is_last||t.force_color?r("pretty-checkbox",{staticClass:"p-curve testing-pretty admin_multiple_variant_input__pretty_input",class:t.is_selected(i)?"p-default":"p-default-o",attrs:{name:"check",color:i.attempt_color(t.attempt,t.force_color),checked:!0,disabled:!0}}):r("pretty-checkbox",{staticClass:"p-curve testing-pretty admin_multiple_variant_input__pretty_input",class:t.is_selected(i)?"p-default":"p-default-o",attrs:{name:"check",checked:!0,disabled:!0}}),t._v(" "),r("div",{staticClass:"inline-block m-l-xs",class:{"font-16 l-h-20":t.$yandex},domProps:{innerHTML:t._s(i.values.rendered_content)}})],1)})),0)}),[],!1,null,null,null).exports,ct={name:"report-question-input",components:{InputReportDropdown:nt},props:{question_input:{type:A.b,required:!0},attempt:{type:u.a,required:!0}},computed:{answer:function answer(){var t=this.attempt.get_input_answers(this.question_input.values.id);return t.length?t[0].values.answer:this.$gettext("Нет ответа")},is_teacher:function is_teacher(){var t;return null===(t=this.$store.state.login.user_data)||void 0===t?void 0:t.is_teacher}}},_t=Object($.a)(ct,(function(){var t=this.$createElement,i=this._self._c||t;return i("div",[i("div",{staticClass:"form-group"},[i("div",{staticClass:"input-group nowrap shp-full-width"},[i("input",{staticClass:"form-control",attrs:{disabled:""},domProps:{value:this.answer}}),this._v(" "),this.attempt.values.is_last||this.is_teacher?i("input-report-dropdown",{attrs:{question_variants:this.question_input.question_variants,attempt:this.attempt}}):this._e()],1)])])}),[],!1,null,null,null).exports,pt={name:"report-question-textarea",components:{InputReportDropdown:nt},props:{question_input:{type:A.b,required:!0},attempt:{type:u.a,required:!0}},computed:{answer:function answer(){var t=this.attempt.get_input_answers(this.question_input.values.id);return t.length?t[0].values.answer:this.$gettext("Нет ответа")}},mounted:function mounted(){Object(b.l)(this.$refs.textarea)}},dt=Object($.a)(pt,(function(){var t=this.$createElement,i=this._self._c||t;return i("div",{staticClass:"input-group nowrap shp-full-width"},[i("textarea",{ref:"textarea",staticClass:"shp-full-width large-textarea form-control vertical-resize m-b-xs",class:this.question_input.css_classes,attrs:{disabled:""},domProps:{value:this.answer}}),this._v(" "),this.attempt.is_published?i("input-report-dropdown",{attrs:{question_variants:this.question_input.question_variants,attempt:this.attempt}}):this._e()],1)}),[],!1,null,null,null).exports,mt=r(244),ht={name:"attempt-question-input",components:{ReportQuestionTextarea:dt,ReportQuestionInput:_t,ReportMultipleVariantInput:lt,ReportSelectInput:rt,ReportVariantInput:Y.a,AttemptMultipleVariantInput:K,AttemptVariantInput:X,AttemptSelect:U,AttemptInput:z,AttemptTextarea:N,AttemptInputReport:R},props:{question_input:{type:A.b,required:!0},attempt:{type:u.a,required:!0},scoring:{type:C.b,required:!1},protocol:{required:!1,default:!1}},data:function data(){return{attempt_timers:new mt.b(this.attempt.testing_timing).create_timers()}}},ft=(r(2720),Object($.a)(ht,(function(){var t,i,r=this,a=r.$createElement,o=r._self._c||a;return o("div",{class:(t={"inline-flex to-top":!0},t[r.question_input.css_classes]=!0,t)},[r.protocol||(r.attempt_timers.is_finished||r.attempt.values.is_finished||(r.$store.state.login.user_data.is_pupil||r.$store.state.login.user_data.is_client)&&r.attempt.is_finished)&&!r.$route.meta.is_abstract?r.question_input?[o("attempt-input-report",{class:(i={},i[r.question_input.css_classes]=!0,i.flex="custom"===r.question_input.values.widget,i["inline-flex"]="custom"!==r.question_input.values.widget,i),attrs:{question_input:r.question_input,attempt:r.attempt,input_scoring:r.scoring&&r.scoring.get_question_input_scoring(r.question_input.values.id)}},["select"===r.question_input.values.widget?o("report-select-input",{staticClass:"to-top",attrs:{question_input:r.question_input,attempt:r.attempt}}):"yes_no"===r.question_input.values.widget||"variant"===r.question_input.values.widget?o("report-variant-input",{staticClass:"inline-block to-top",attrs:{question_input:r.question_input,attempt:r.attempt}}):"multiple_variant"===r.question_input.values.widget?o("report-multiple-variant-input",{staticClass:"inline-block to-top",attrs:{question_input:r.question_input,attempt:r.attempt}}):"custom"===r.question_input.values.widget?o("report-question-textarea",{staticClass:"to-top",attrs:{question_input:r.question_input,attempt:r.attempt}}):"input"===r.question_input.values.widget?o("report-question-input",{staticClass:"to-top",attrs:{question_input:r.question_input,attempt:r.attempt}}):r._e()],1)]:r._e():["select"===r.question_input.values.widget?o("attempt-select",{staticClass:"to-top",attrs:{question_input:r.question_input,attempt:r.attempt}}):"yes_no"===r.question_input.values.widget||"variant"===r.question_input.values.widget?o("attempt-variant-input",{staticClass:"inline-block to-top",attrs:{question_input:r.question_input,attempt:r.attempt}}):"multiple_variant"===r.question_input.values.widget?o("attempt-multiple-variant-input",{staticClass:"inline-block to-top",attrs:{question_input:r.question_input,attempt:r.attempt}}):"custom"===r.question_input.values.widget?o("attempt-textarea",{attrs:{question_input:r.question_input,attempt:r.attempt}}):"input"===r.question_input.values.widget?o("attempt-input",{staticClass:"to-top",attrs:{question_input:r.question_input,attempt:r.attempt}}):[o("span",{staticClass:"text-danger"},[r._v(r._s(r.question_input.values.widget))])]]],2)}),[],!1,null,null,null).exports),vt={name:"attempt-question-content",components:{AttemptQuestionInput:ft},props:{question:{type:E.b,required:!0},attempt:{type:u.a,required:!0},scoring:{required:!1},protocol:{required:!1,default:!1}},render:function render(t){var i=new E.d(this.question).input_template((function(t){return"<attempt-question-input v-if=\"question.get_input('".concat(t.values.name,"')\" :question_input=\"question.get_input('").concat(t.values.name,'\')" :attempt="attempt" :scoring="scoring" :protocol="protocol"></attempt-question-input>')})).get_template(),r=this;return t({template:i,name:"attempt-question",components:{AttemptQuestionInput:ft},computed:{protocol:function protocol(){return r.protocol},question:function question(){return r.question},attempt:function attempt(){return r.attempt},scoring:function scoring(){return r.scoring}},mounted:function mounted(){window.$(this.$refs.question).find("table:not(.table)").removeAttr("border").addClass("table table-condensed table-stripped table-bordered")}})}},gt=Object($.a)(vt,void 0,void 0,!1,null,null,null).exports,wt=r(63),bt={name:"attempt-question-report",components:{HighlightTex:r(1623).a,AlertError:wt.a,AttemptQuestionContent:gt},props:{question:{type:E.b,required:!0},attempt:{type:u.a,required:!0},scoring:{type:C.b,required:!1},show_results:{required:!1,default:!1}},data:function data(){return{style:"font-size: 18px; line-height: 34px;"}},computed:{errors_amount:function errors_amount(){return this.scoring.inputs_scoring.filter((function(t){return 0!==t.wrong_answers.length})).length}}},qt={name:"QuestionCardPassingContent",components:{AttemptQuestionReport:Object($.a)(bt,(function(){var t=this,i=t.$createElement,r=t._self._c||i;return r("div",[t.scoring&&t.scoring.is_errors()&&t.scoring.is_have_result()&&t.attempt.is_published&&+t.question.values.max_errors<t.errors_amount?r("div",{staticClass:"panel-body scroll-x-auto"},[r("div",{staticClass:"bs-callout bs-callout-danger no-top no-bottom"},[r("span",{staticClass:"h4"},[t._v(t._s(t.$gettext("Превышено допустимое количество ошибок")))])])]):t._e(),t._v(" "),r("div",{staticClass:"panel-body scroll-x-auto"},[r("highlight-tex",{attrs:{enable:"tex"===t.question.values.type||t.question.values.mathjax_enabled}},[r("attempt-question-content",{attrs:{question:t.question,attempt:t.attempt,scoring:t.scoring,protocol:t.show_results}})],1),t._v(" "),r("alert-error",{attrs:{uid:t.attempt.uid}})],1)])}),[],!1,null,null,null).exports,SlideXRightTransition:r(1628).c},props:{question:{required:!0,type:E.b},testing_attempt:{required:!0,type:u.a},show_results:{required:!1,default:!1},question_scoring:{required:!1,type:C.b},show_header:{type:Boolean,default:!0}}},yt=Object($.a)(qt,(function(){var t=this,i=t.$createElement,r=t._self._c||i;return r("div",{key:t.question.uid,ref:"question"},[r("slide-x-right-transition",{key:t.question.uid},[r("div",{staticClass:"panel panel-default"},[t.show_header?r("div",{staticClass:"panel-heading"},[r("div",{staticClass:"panel-title monospace-font"},[t._v("\n          "+t._s(t.question.values.number)+".\n          "),t.testing_attempt.values.is_last&&t.testing_attempt.is_finished?[r("span",{staticClass:"label",class:t.question_scoring.get_label_color()},[t._v(t._s(t.question_scoring.score_text(t.show_results))+" из "+t._s(t.question.values.score)+" ")])]:[r("span",{staticClass:"label label-info"},[t._v(" "+t._s(t.question.values.score)+"\n              "+t._s(t.$ngettext("балл","баллов",t.question.values.score))+"\n            ")])]],2)]):t._e(),t._v(" "),r("attempt-question-report",{staticClass:"question-container",attrs:{question:t.question,attempt:t.testing_attempt,scoring:t.question_scoring,show_results:t.show_results}})],1)])],1)}),[],!1,null,null,null).exports,xt={name:"testing-attempt-passing",components:{QuestionPassingResultScroll:j,QuestionPassingScroll:k,TestingQuestionLayout:r(2278).a,QuestionCardPassingContent:yt},props:{testing:{required:!0,type:o.b},testing_attempt:{required:!0,type:u.a},show_results:{required:!1,default:!1}},data:function data(){var t=this,i=new l.b("attempt:".concat(this.testing_attempt.values.id,":question:input")).single().use_possible((function(){return t.testing.values.questions})).by_default(this.testing.values.questions.length&&this.testing.values.questions[0]);return this.testing.is_display_list&&i.on_open.push((function(i){var r=document.body;t.$parent&&t.$parent.$parent&&t.$parent.$parent.$el.classList.contains("modal")&&(r=t.$parent.$parent.$el),t.$scrollTo(t.$refs[i][0].$el,600,{container:r})})),{checked:i}},computed:{opened_questions:function opened_questions(){var t=this;return this.testing.questions.filter((function(i){return t.checked.is_open(i.values.id)}))},questions:function questions(){return this.testing.is_display_list?this.testing.questions:this.opened_questions}},methods:{get_question_scoring:function get_question_scoring(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(g.isRequired)();if(this.show_results||this.testing_attempt.values.is_finished&&this.testing_attempt.values.is_last)return new C.b(this.$store.state,this.testing_attempt,t)}}},$t=Object($.a)(xt,(function(){var t=this,i=t.$createElement,r=t._self._c||i;return r("div",{staticClass:"panel-body mb-lg",class:{testing_panel__display_list:t.testing.is_display_list}},[t.testing_attempt.is_finished&&t.testing.is_multiple_questions?r("QuestionPassingResultScroll",{staticClass:"clearfix",attrs:{questions:t.testing.questions,testing_attempt:t.testing_attempt,checked:t.checked,protocol:t.show_results}}):r("QuestionPassingScroll",{staticClass:"clearfix",attrs:{testing:t.testing,testing_attempt:t.testing_attempt,checked:t.checked}}),t._v(" "),r("TestingQuestionLayout",{attrs:{testing:t.testing,checked:t.checked}},[t._l(t.questions,(function(i){return[r("QuestionCardPassingContent",{key:i.uid,ref:i.values.id,refInFor:!0,staticClass:"testing_panel__display_list",attrs:{show_header:t.testing.is_multiple_questions,question:i,question_scoring:t.get_question_scoring(i),testing_attempt:t.testing_attempt,show_results:t.show_results}})]}))],2)],1)}),[],!1,null,null,null);i.a=$t.exports},2348:function(t,i,r){"use strict";r(43),r(7),r(28),r(68),r(11),r(12),r(105),r(25),r(153);var a=r(622),o=r(97),u=r(22),l=r(330),c=r(843),_=r(244),p=r(34),d=r.n(p),m=r(20),h=r.n(m),v=r(63),g={name:"TestingAttemptConfirmModal",props:{is_open:{type:Boolean,default:!1}},methods:{confirm:function confirm(){this.$emit("update:is_open",!1),this.$emit("confirm")}}},w=r(3),b=Object(w.a)(g,(function(){var t=this,i=t.$createElement,r=t._self._c||i;return r("modal",{ref:"modal",attrs:{value:t.is_open,"append-to-body":!0,size:"sm"},on:{input:function(i){return t.$emit("update:is_open",i)}}},[r("template",{slot:"title"},[r("h3",[t._v(t._s(t.$gettext("Завершение тестирования")))])]),t._v(" "),[r("div",{staticClass:"font-lg mb-4"},[t._v("\n      "+t._s(t.$gettext("Внимание! Тестирование нельзя будет пройти повторно после того, как будут показаны правильные ответы."))+"\n    ")]),t._v(" "),r("div",{staticClass:"font-lg"},[t._v("\n      "+t._s(t.$gettext("Показать ответы и завершить тестирование?"))+"\n    ")])],t._v(" "),r("template",{slot:"footer"},[r("div",{staticClass:"row"},[r("div",{staticClass:"col-xs-6"},[r("a",{staticClass:"btn btn-default btn-lg full-width",on:{click:t.confirm}},[t._v(t._s(t.$gettext("Да")))])]),t._v(" "),r("div",{staticClass:"col-xs-6"},[r("a",{staticClass:"btn btn-primary btn-lg full-width",on:{click:function(i){return t.$emit("update:is_open",!1)}}},[t._v(t._s(t.$gettext("Нет")))])])])])],2)}),[],!1,null,"6dc9de7e",null).exports,q=r(2344),y=r(21),x=r(4),$=r.n(x),k=r(5),C=r.n(k),O=(r(33),r(31),r(70),r(82),r(41),r(88),r(29),r(53),r(36),r(116),r(117),r(59)),j=r(0),E=r(1);function _createForOfIteratorHelper(t,i){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function _unsupportedIterableToArray(t,i){if(!t)return;if("string"==typeof t)return _arrayLikeToArray(t,i);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray(t,i)}(t))||i&&t&&"number"==typeof t.length){r&&(t=r);var a=0,o=function F(){};return{s:o,n:function n(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function e(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var u,l=!0,c=!1;return{s:function s(){r=r.call(t)},n:function n(){var t=r.next();return l=t.done,t},e:function e(t){c=!0,u=t},f:function f(){try{l||null==r.return||r.return()}finally{if(c)throw u}}}}function _arrayLikeToArray(t,i){(null==i||i>t.length)&&(i=t.length);for(var r=0,a=new Array(i);r<i;r++)a[r]=t[r];return a}var A=function(){function QuestionInputAttemptValidator(t,i){$()(this,QuestionInputAttemptValidator),this.attempt=t,this.question_input=i,this.uid="attempts:".concat(t.values.id,":input:").concat(i.values.id),this.error=""}return C()(QuestionInputAttemptValidator,[{key:"validate",value:function validate(){return this.question_input.values.required&&!this.attempt.get_input_answers(this.question_input.values.id).length&&(this.error=Object(j.$gettext)("На этот вопрос нужно дать ответ")),this}}]),QuestionInputAttemptValidator}(),S=function(){function AttemptValidator(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(E.isRequired)(),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(E.isRequired)();$()(this,AttemptValidator),this.attempt=t,this.testing=i}return C()(AttemptValidator,[{key:"clear_errors",value:function clear_errors(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(E.isRequired)(),r=_createForOfIteratorHelper(this.testing.questions);try{for(r.s();!(t=r.n()).done;){var a,o=t.value,u=_createForOfIteratorHelper(o.inputs);try{for(u.s();!(a=u.n()).done;){var l=a.value,c=new A(this.attempt,l);new O.b(c.uid).hide_error(i)}}catch(t){u.e(t)}finally{u.f()}}}catch(t){r.e(t)}finally{r.f()}}},{key:"get_question_errors",value:function get_question_errors(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(E.isRequired)(),r={},a=_createForOfIteratorHelper(this.testing.questions);try{for(a.s();!(t=a.n()).done;){var o,u=t.value,l=_createForOfIteratorHelper(u.inputs);try{for(l.s();!(o=l.n()).done;){var c=o.value,_=new A(this.attempt,c).validate();_.error.length&&(r[c.values.id]=_,new O.b(_.uid).show_error(i,_.error))}}catch(t){l.e(t)}finally{l.f()}}}catch(t){a.e(t)}finally{a.f()}return r}},{key:"get_question_errors_without_show",value:function get_question_errors_without_show(){var t,i={},r=_createForOfIteratorHelper(this.testing.questions);try{for(r.s();!(t=r.n()).done;){var a,o=_createForOfIteratorHelper(t.value.inputs);try{for(o.s();!(a=o.n()).done;){var u=a.value,l=new A(this.attempt,u).validate();l.error.length&&(i[u.values.id]=l)}}catch(t){o.e(t)}finally{o.f()}}}catch(t){r.e(t)}finally{r.f()}return i}}]),AttemptValidator}(),R=r(867),I=function(){function FinishAttemptOperator(t,i){$()(this,FinishAttemptOperator),this.testing_attempt=t,this.testing=i,this.input_errors={},this.has_errors=!1}return C()(FinishAttemptOperator,[{key:"clear_errors",value:function clear_errors(){this.has_errors=!1,this.input_errors={}}},{key:"has_empty_inputs",value:function has_empty_inputs(t){var i=new S(this.testing_attempt,this.testing);return this.input_errors=i.get_question_errors_without_show(t),Object.keys(this.input_errors).length}},{key:"finish",value:function finish(){var t=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(E.isRequired)(),r=new S(this.testing_attempt,this.testing);if(r.clear_errors(i),this.clear_errors(),this.input_errors=r.get_question_errors(i),this.has_errors=Object.keys(this.input_errors).length,!this.has_errors){var a=u.b["api:testing_attempt_finish_api"](this.testing_attempt.values.id);new y.a(a,this.testing_attempt.uid).on_success((function(i){var r=u.b["api:testing_attempt_extended_detail_api"](t.testing_attempt.values.id);new y.a(r,t.testing_attempt.uid).get().on_success(y.c.update_instance(l.a)).execute(i,{}),r=u.b["api:testing_content_api"](t.testing_attempt.values.testing_id),new y.a(r,t.testing_attempt.uid).get().on_success(y.c.update_instance(R.a)).execute(i,{})})).execute(i,{})}}}]),FinishAttemptOperator}(),T=r(19),P=r.n(T),Q={name:"testing-attempt-footer-text",props:{testing:{required:!0,type:a.b},unit_timers:{required:!0,type:_.b},last_attempt:{required:!0,type:c.a}},data:function data(){return{start_at:P()(this.unit_timers.unit_timing.date_from).fromNow(),is_attempt_finished:this.last_attempt.is_finished&&this.last_attempt.values.number>=this.testing.values.max_attempts}},computed:{is_published:function is_published(){return P()(this.unit_timers.unit_timing.publish_date)._d<new Date},publish_date:function publish_date(){return P()(this.unit_timers.unit_timing.publish_date).calendar().toLowerCase()},finish:function finish(){return this.is_attempt_finished||this.unit_timers.is_finished||this.last_attempt.values.is_last}}},D=Object(w.a)(Q,(function(){var t=this,i=t.$createElement,r=t._self._c||i;return r("div",[t.unit_timers.is_started?t.finish?[r("p",{staticClass:"lead text-amazing text-center testing__finished-text"},[t.unit_timers.is_finished?[t._v("\n        "+t._s(t.$gettext("Тестирование окончено"))+"\n      ")]:t.is_attempt_finished?[t._v("\n        "+t._s(t.$gettext("Попытки прохождения закончились"))+"\n      ")]:[t._v("\n        "+t._s(t.$gettext("Тестирование завершено"))+"\n      ")],t._v(" "),t.is_published?[t._v("\n        , "+t._s(t.$gettext("посмотрите правильные ответы"))+"\n      ")]:[t._v("\n        , "+t._s(t.$gettext("правильные ответы будут опубликованы"))+" "+t._s(t.publish_date)+"\n      ")]],2)]:[t.last_attempt.is_finished?t.is_published?r("p",{staticClass:"lead text-amazing text-center testing-end"},[t._v("\n      "+t._s(t.$gettext("Улучшите свой результат или посмотрите правильные ответы"))+"\n    ")]):r("p",{staticClass:"lead text-amazing text-center testing-end"},[t._v("\n      "+t._s(t.$gettext("Ваши ответы приняты, результаты будут опубликованы"))+" "+t._s(t.publish_date)+"\n    ")]):void 0]:r("p",{staticClass:"lead text-warning text-center testing__start-text"},[t._v("\n    "+t._s(t.$gettext("Тестирование начнётся через"))+" "+t._s(t.start_at)+"\n  ")])],2)}),[],!1,null,null,null).exports,M=r(379),H=r(45),L=r(868),B=(r(546),r(547),r(548),r(549),r(550),r(551),r(552),r(553),r(554),r(555),r(556),r(557),r(558),r(559),r(65),r(332),r(1883)),N=r(323),V=r(887),z=function(){function TestingAnswerWatcher(t,i,r){var a=this;$()(this,TestingAnswerWatcher),this.$store=t,this.state=t.state,this.attempt=r,this.testing=i,this.queue=new Map,this.pending=new Map,this.errors=new Map,this.is_pending=!1,this.watcher=setInterval((function(){a.testing.questions.forEach((function(t){t.question_inputs.forEach((function(t){t.is_text_input&&a.update_input_in_queue(t.values.id)}))})),t.state.attempts.is_wait_send&&a.$store.commit("attempts/release_wait"),a.queue.forEach((function(t,i){a.send_text_input(i,t)}))}),1e3)}return C()(TestingAnswerWatcher,[{key:"send_text_input",value:function send_text_input(t,i){var r=this,a=Object(B.b)(i.attempt,t);if(!(this.pending.has(t)||this.errors.has(t)&&this.errors.get(t)===i.answer)){this.pending.set(t,"key"),this.is_pending=!0;var o=u.b["api:testing_attempt_answer_input_api"](this.attempt.values.id);new y.a(o,a).on_success(y.c.update_instance(N.a)).on_success(y.c.add_related(l.a.relations.question_answers,this.attempt.values.id)).on_success((function(){r.pending.delete(t),r.is_pending=r.pending.size>0})).on_success((function(){return r.update_input_in_queue(t)})).on_error(y.c.show_errors(a,!0)).on_error((function(a,o){o.response&&o.response.status<500&&(r.errors.set(t,i.answer),r.queue.delete(t)),r.pending.delete(t),r.is_pending=r.pending.size>0})).execute(this.$store,i)}}},{key:"update_input_in_queue",value:function update_input_in_queue(t){var i=this.get_answers().find((function(i){return i.values.input_id===t})),r="".concat(t,"|").concat(this.attempt.values.id),a=this.state.models.input_answers&&this.state.models.input_answers[r];void 0!==a&&this.errors.has(t)&&this.errors.get(t).trim()!==String(a.answer).trim()&&this.errors.delete(t),void 0===a||i&&String(a.answer).trim()===i.values.answer.trim()?this.queue.delete(t):this.queue.set(t,{input:t,attempt:this.attempt.values.id,answer:String(a.answer).trim()})}},{key:"get_answers",value:function get_answers(){var t=this;return(this.state.models.testing_attempts[this.attempt.values.id].question_answers||[]).map((function(i){return new V.a(t.state.models.question_answers[i],t.state)}))}},{key:"destroy",value:function destroy(){this.watcher&&(clearInterval(this.watcher),this.watcher=void 0),this.$store.commit("attempts/release_wait")}}]),TestingAnswerWatcher}(),W={name:"testing-attempt-main",components:{TestingAttemptConfirmModal:b,TestingAttemptFooterText:D,TestingAttemptPassing:q.a,AlertError:v.a},props:{testing_attempt:{required:!0,type:c.a},testing:{required:!0,type:a.b},unit_timers:{required:!0,type:_.b},last_attempt:{required:!0,type:c.a}},data:function data(){var t=new o.c(u.b["api:testing_attempt_extended_detail_api"](this.testing_attempt.values.id),l.a),i="attempt:passing:".concat(this.testing_attempt.values.id),r=new o.c(u.b["api:testing_content_api"](this.testing.values.id),R.a);return(new H.d).insert_list(this.$store,L.a,[]),{uid:i,attempt_instance:new M.b(i,t),testing_instance:new M.b("testing:".concat(this.testing.values.id),r),is_admin:!0,user_data:this.$store.state.login.user_data,watcher:new z(this.$store,this.testing,this.testing_attempt),is_confirm_open:!1}},computed:{is_active:function is_active(){return this.unit_timers.is_active},finish_button:function finish_button(){return this.user_data.is_client&&this.unit_timers.is_active||!this.user_data.is_client},finish_operator:function finish_operator(){return new I(this.testing_attempt,this.testing)},can_show_answers:function can_show_answers(){return this.unit_timers.is_show_answers&&!this.last_attempt.values.is_last},is_pending:function is_pending(){return this.watcher.is_pending||this.$store.state.attempts.lock>0||this.$store.state.attempts.is_wait_send},has_empty_inputs:function has_empty_inputs(){return this.finish_operator.has_empty_inputs(this.$store)}},methods:{fetch:function fetch(){this.attempt_instance.fetch(this.$store)},restart:function restart(){this.$emit("restart")},cancel:function cancel(){this.$emit("cancel")},open_results_confirm:function open_results_confirm(){if(this.unit_timers.is_finished)return this.show_answers();this.is_confirm_open=!0},_show_answers:function _show_answers(){return new y.a(u.b["api:testing_show_answers_api"](this.testing.values.id),this.uid).execute(this.$store,{})},show_answers:function show_answers(){var t=this;return d()(h.a.mark((function _callee(){return h.a.wrap((function _callee$(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,t._show_answers();case 2:return i.next=4,t.testing_instance.fetch(t.$store);case 4:return i.next=6,t.fetch(t.$store);case 6:case"end":return i.stop()}}),_callee)})))()},finish:function finish(){this.finish_operator.finish(this.$store);var t=this.finish_operator.input_errors||{},i=Object.values(t);if(i.length)return this.$scrollTo("#question"+i[0].question_input.values.question_id,400,{offset:-60,x:!0,container:"#scroll"})}},beforeDestroy:function beforeDestroy(){this.attempt_instance.destroy(this.$store),this.testing_instance.destroy(this.$store),this.watcher.destroy()}},U=Object(w.a)(W,(function(){var t=this,i=t.$createElement,r=t._self._c||i;return r("div",[t.testing_attempt?r("div",[t.testing_attempt?r("testing-attempt-passing",{attrs:{testing_attempt:t.testing_attempt,testing:t.testing}}):t._e(),t._v(" "),r("alert-error",{attrs:{uid:t.uid}})],1):t._e(),t._v(" "),t.$store.state.login.user_data.is_representative?t._e():r("div",{staticClass:"panel-footer clearfix"},[t._t("footer"),t._v(" "),r("testing-attempt-footer-text",{staticClass:"col-xs-10 col-xs-offset-1",attrs:{unit_timers:t.unit_timers,testing:t.testing,last_attempt:t.last_attempt}}),t._v(" "),t.testing_attempt?[t.last_attempt.values.is_finished?t._e():r("div",{staticClass:"row"},[r("div",{staticClass:"flex flex-center",class:{"col-xs-6":!t.user_data.is_client,"col-xs-12":t.user_data.is_client}},[t.finish_button?r("button",{staticClass:"btn btn-lg btn-primary full-width end-btn",class:{disabled:t.is_pending||t.has_empty_inputs},on:{click:function(i){!t.is_pending&&!t.has_empty_inputs&&t.finish()}}},[t.is_pending?r("i",{staticClass:"icon-spinner icon-spin"}):t._e(),t._v(" "+t._s(t.$gettext("Завершить"))+"\n          ")]):t._e()]),t._v(" "),r("div",{staticClass:"col-xs-6 flex flex-center"},[t.user_data.is_client?t._e():r("button",{staticClass:"btn btn-lg btn-default full-width cancel-btn",on:{click:t.cancel}},[t._v("\n              "+t._s(t.$gettext("Отменить"))+"\n            ")])])]),t._v(" "),t.last_attempt.values.is_finished?t._e():r("div",{staticClass:"m-t-sm text-muted text-center"},[t._v(t._s(t.$gettext("По истечении времени тестирование завершится автоматически")))]),t._v(" "),t.last_attempt.values.is_finished&&(t.user_data.is_client&&!t.last_attempt.values.is_last&&t.unit_timers.is_active&&t.last_attempt.values.number<t.testing.values.max_attempts||!t.user_data.is_client)?[r("div",{staticClass:"row"},[!t.$yandex||!t.can_show_answers&&(t.$store.state.login.user_data.is_pupil||t.$store.state.login.user_data.is_client||t.last_attempt.values.is_last)?t._e():r("div",{staticClass:"col-xs-6 flex flex-center"},[r("btn",{staticClass:"btn-lg",attrs:{type:"inverse"},on:{click:function(i){t.is_confirm_open=!0}}},[t._v("\n                "+t._s(t.$gettext("Показать ответы"))+"\n              ")])],1),t._v(" "),r("div",{staticClass:"flex flex-center",class:{"col-xs-6":t.can_show_answers||!(t.$store.state.login.user_data.is_pupil||t.$store.state.login.user_data.is_client||t.last_attempt.values.is_last),"col-xs-12 ":!(t.can_show_answers||!(t.$store.state.login.user_data.is_pupil||t.$store.state.login.user_data.is_client||t.last_attempt.values.is_last))}},[r("btn",{class:{"btn-lg":t.can_show_answers,"col-xs-12":!t.$yandex},attrs:{type:"primary btn-lg"},on:{click:function(i){return t.restart()}}},[t._v("\n                "+t._s(t.$gettext("Улучшить результат"))+"\n              ")])],1),t._v(" "),t.$yandex||!t.can_show_answers&&(t.$store.state.login.user_data.is_pupil||t.$store.state.login.user_data.is_client||t.last_attempt.values.is_last)?t._e():r("div",{staticClass:"col-xs-6 flex flex-center"},[r("btn",{staticClass:"btn-lg col-xs-12",attrs:{type:"inverse"},on:{click:function(i){t.is_confirm_open=!0}}},[t._v("\n                "+t._s(t.$gettext("Показать ответы"))+"\n              ")])],1)])]:t.user_data.is_client&&t.unit_timers.is_finished&&t.unit_timers.is_show_answers&&!t.last_attempt.values.is_last?[r("div",{staticClass:"row"},[r("div",{staticClass:"col-xs-12 flex flex-center"},[r("btn",{staticClass:"btn-lg col-xs-6",attrs:{type:"inverse"},on:{click:t.open_results_confirm}},[t._v("\n                "+t._s(t.$gettext("Показать ответы"))+"\n              ")])],1)])]:t._e()]:t._e()],2),t._v(" "),r("testing-attempt-confirm-modal",{attrs:{is_open:t.is_confirm_open},on:{"update:is_open":function(i){t.is_confirm_open=i},confirm:function(i){return t.show_answers()}}})],1)}),[],!1,null,null,null).exports,J=r(293),X={name:"testing-attempt-welcome",components:{ErrorMessage:r(299).a},props:{testing:{required:!0,type:a.b},unit_timers:{required:!0,type:_.b},uid:{required:!0}},data:function data(){var t=this,i=new _.a(this.unit_timers.unit_timing.date_from).on_tick((function(){t.start_at=P()(t.unit_timers.unit_timing.date_from).fromNow()})).start();return{user_data:this.$store.state.login.user_data,start_timer:i,start_at:P()(this.unit_timers.unit_timing.date_from).fromNow()}},beforeDestroy:function beforeDestroy(){this.start_timer.destroy()}},G=Object(w.a)(X,(function(){var t=this,i=t.$createElement,r=t._self._c||i;return r("div",[r("div",{staticClass:"panel-heading clearfix"},[r("div",{staticClass:"panel-title col-xs-no-padding col-xs-6"},[r("span",{staticClass:"shp-donut shp-donut-info"}),t._v("\n    "+t._s(t.$gettext("Попытка 1"))+"\n  ")]),t._v(" "),r("div",{staticClass:"col-xs-6 col-xs-no-padding text-right h4"},[t._t("heading_buttons")],2)]),t._v(" "),r("div",{staticClass:"panel-background"},[r("div",{staticClass:"testing-jumbotron"},[r("error-message",{attrs:{uid:t.uid,classes:"lead text-center"}},[r("template",{slot:"no-errors"},[!t.user_data.is_client||t.unit_timers.is_started&&!t.unit_timers.is_finished?r("p",{staticClass:"lead text-center testing__text"},[t._v("\n            "+t._s(t.$gettext("Нажмите кнопку начать для начала решения тестирования"))+"\n          ")]):t._e(),t._v(" "),t.unit_timers.is_finished?r("p",{staticClass:"lead text-amazing text-center testing__text"},[t._v("\n              "+t._s(t.$gettext("Тестирование завершено"))+"\n          ")]):t.unit_timers.is_started?t._e():r("p",{staticClass:"lead text-warning text-center testing__text"},[t._v("\n            "+t._s(t.$gettext("Тестирование начнётся через"))+" "+t._s(t.start_at)+"\n          ")])])],2)],1)])])}),[],!1,null,null,null).exports,K=r(2418),Y=r(2419),Z=r(502),tt=r(657),et=r(1893),st=r(522);function object_find(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(E.isRequired)(),r=[];if(t)for(var a in t)t.hasOwnProperty(a)&&i(t[a])&&r.push(t[a]);return r}var nt={name:"testing-attempt-list",components:{TestingAttemptSelect:Y.a,TestingAttemptSecondHeading:K.a,TestingAttemptWelcome:G,RefreshError:J.a,AlertError:v.a,TestingAttemptMain:U},props:{testing:{required:!0,type:a.b},unit_id:{required:!0,type:Number}},data:function data(){var t=this,i=Object(st.b)(this.$store.state,this.unit_id),r=new _.b(i).create_timers();r.start_timer.on_event((function(){return t.get_current_attempt()})),r.end_timer.on_event((function(){return t.get_current_attempt()})),r.end_timer.on_event((function(){!function finish_unit(t,i,r){if(r.is_finished()){var a=object_find(t.state.models.testings,(function(t){return t.unit_id===i})).map((function(t){return t.id}));object_find(t.state.models.testing_attempts,(function(t){return a.indexOf(t.testing_id)>=0})).forEach((function(i){(new H.d).insert(t,l.a,{result:{id:i.id,is_finished:!0}})}))}}(t.$store,t.unit_id,i)}));var a=new o.c(u.b["api:testing_attempt_current_api"](this.testing.values.id),l.a),p="current_testing_attempt:".concat(this.testing.values.id),d=new o.c(u.b["api:testing_attempt_extended_list_api"](),l.a);return this.$store.state.login.user_data.is_client&&(d=new o.c(u.b["api:testing_testing_attempt_extended_list_api"](this.testing.values.id),l.a)),{uid:p,show_history:!1,current_instance:new M.b(p,a),last_attempt_data:new o.a("attempt:last:".concat(this.testing.values.id),d).add_query_filter({testing_id:this.testing.values.id,user_id:this.$store.state.login.user_data.id,orderBy:"-number"}).set_limit(1),prev_attempt_data:new o.a("attempt:last:".concat(this.testing.values.id),d).add_query_filter({testing_id:this.testing.values.id,user_id:this.$store.state.login.user_data.id,orderBy:"-number"}).set_limit(1),unit_timers:r,user_data:this.$store.state.login.user_data,select_data:new c.b(this.testing.values.id,this.$store.state)}},mounted:function mounted(){},computed:{selected_attempt:function selected_attempt(){return this.prev_attempt||this.last_attempt||this.current_attempt},current_attempt:function current_attempt(){return this.current_instance.ids.length?l.a.get_instance(this.$store,c.a,this.current_instance.ids[0]):null},last_attempt:function last_attempt(){return this.last_attempt_data.ids.length?l.a.get_instance(this.$store,c.a,this.last_attempt_data.ids[0]):null},prev_attempt:function prev_attempt(){return this.prev_attempt_data.ids.length?l.a.get_instance(this.$store,c.a,this.prev_attempt_data.ids[0]):null},max_result_attempt:function max_result_attempt(){var t=this;if(this.$store.state.models.testing_attempts){var i=Object.values(this.$store.state.models.testing_attempts).filter((function(i){return i.testing_id===t.testing.values.id})).sort((function(t,i){return i.score-t.score}));return i[0]&&new c.a(i[0],this.$store.state)}}},created:function created(){this.get_current_attempt()},beforeDestroy:function beforeDestroy(){this.current_instance.destroy(this.$store),this.last_attempt_data.destroy(this.$store),this.prev_attempt_data.destroy(this.$store),this.unit_timers.destroy()},methods:{get_current_attempt:function get_current_attempt(){new M.a(this.current_instance).post().fetch(this.$store)},get_prev_attempt:function get_prev_attempt(){this.last_attempt_data.fetch(this.$store)},restart:function restart(){var t=this,i=Object(et.a)(this.$store.state),r=new y.a(u.b["api:testing_attempt_create_api"](this.testing.values.id),this.uid).on_success((function(){return t.$refs.heading&&t.$scrollTo(t.$refs.heading.$el,600)})).on_success(y.c.update_instance(l.a)).on_success((function(i,r){new Z.a(t.last_attempt_data).remove_ids(t.$store,t.last_attempt_data.ids),new Z.a(t.prev_attempt_data).remove_ids(t.$store,t.prev_attempt_data.ids),t.current_instance.push_id(t.$store,r.data.id)}));i&&r.on_success(y.c.add_related(tt.a.relations.testing_attempts,i.values.id)),r.execute(this.$store,{})},cancel:function cancel(){var t=this;new y.a(u.b["api:testing_attempt_delete_api"](this.current_attempt.values.id),this.uid).on_success((function(){return t.$refs.heading&&t.$scrollTo(t.$refs.heading.$el,600)})).on_success(y.c.remove_instance(this.current_attempt.values.id,l.a)).on_success((function(){t.get_prev_attempt()})).execute(this.$store,{})},set_previous:function set_previous(t){this.prev_attempt_data.query_filter.id=t,this.prev_attempt_data.fetch(this.$store)}}},it=Object(w.a)(nt,(function(){var t=this,i=t.$createElement,r=t._self._c||i;return r("div",[t._t("header",null,{max_result_attempt:t.max_result_attempt}),t._v(" "),t.select_data.action_info.is_edit?r("testing-attempt-select",{attrs:{testing:t.testing,current_id:t.selected_attempt&&t.selected_attempt.values.id},on:{open:t.set_previous}}):t._e(),t._v(" "),r("div",{staticClass:"panel panel-default m-b-sm"},[t.selected_attempt?[r("testing-attempt-second-heading",{attrs:{testing:t.testing,attempt:t.selected_attempt,last_attempt:t.last_attempt||t.current_attempt}}),t._v(" "),r("testing-attempt-main",{key:t.selected_attempt.values.id,staticClass:"panel-background testing_attempt_main__yandex_panelbackground",attrs:{testing:t.testing,last_attempt:t.last_attempt||t.current_attempt,testing_attempt:t.selected_attempt,unit_timers:t.unit_timers},on:{restart:t.restart,cancel:t.cancel}},[r("template",{slot:"footer"},[r("alert-error",{attrs:{uid:t.uid}}),t._v(" "),r("refresh-error",{attrs:{slot:"else",uid:t.last_attempt_data.name},on:{refresh:function(i){return t.last_attempt_data.fetch(t.$store)}},slot:"else"})],1)],2)]:t.selected_attempt?t._e():[r("testing-attempt-welcome",{staticClass:"panel-default",attrs:{testing:t.testing,unit_timers:t.unit_timers,uid:t.uid}}),t._v(" "),!t.user_data.is_client||t.unit_timers.is_active?r("div",{staticClass:"panel-footer clearfix"},[r("btn",{staticClass:"btn-lg col-xs-12",attrs:{type:"primary"},on:{click:function(i){return t.get_current_attempt()}}},[t._v(t._s(t.$gettext("Начать")))])],1):t._e()]],2)],2)}),[],!1,null,null,null);i.a=it.exports},2409:function(t,i,r){"use strict";r(7);var a=r(622),o=r(843),u=r(862),l=r(1845),c=r(839),_={name:"TestingAttemptHeading",components:{StepElementHeading:l.a},props:{testing:{required:!0,type:a.b},attempt:{required:!1,type:o.a},step_element:{required:!0,type:c.a}},computed:{unchecked_questions:function unchecked_questions(){var t=this;return this.testing.questions.some((function(i){return!new u.b(t.$store.state,t.attempt,i).is_checked()}))}}},p=r(3),d=Object(p.a)(_,(function(){var t=this,i=t.$createElement,r=t._self._c||i;return r("step-element-heading",{attrs:{step_element:t.step_element}},[r("template",{slot:"name_prefix"},[t._t("name_prefix")],2),t._v(" "),r("template",{slot:"name_suffix"},[t._t("name_suffix")],2),t._v(" "),r("div",{attrs:{slot:"buttons"},slot:"buttons"},[t._t("heading_buttons"),t._v(" "),r("div",{staticClass:"h3 inline-block mt-sm pr-xs no-bottom"},[t.attempt&&t.attempt.values.is_finished&&t.attempt.is_result_published()?r("span",{class:"text-"+t.attempt.get_color(!0,t.unchecked_questions)},[t._v("\n        "+t._s(t.attempt.score)+" / "+t._s(t.testing.score)+"\n      ")]):t.attempt?r("span",{staticClass:"text-info"},[t._v(" ? / "+t._s(t.testing.score)+" ")]):r("span",{staticClass:"text-muted"},[t._v(" - / "+t._s(t.testing.score)+" ")])]),t._v(" "),r("span",{staticClass:"to-top inline-block"},[t._v(" "+t._s(t.$gettext("баллов"))),r("br"),t._v(t._s(t.$gettext("за тест"))+" ")])],2)],2)}),[],!1,null,null,null);i.a=d.exports},2418:function(t,i,r){"use strict";r(11),r(7),r(12);var a=r(622),o=r(843),u=r(862),l={name:"testing-attempt-second-heading",props:{testing:{required:!0,type:a.b},attempt:{required:!0,type:o.a},last_attempt:{required:!0,type:o.a},show_other:{required:!1,default:!1}},data:function data(){return{select_data:new o.b(this.testing.values.id,this.$store.state)}},methods:{open_select:function open_select(){this.select_data.action_operator.edit(this.$store)}},computed:{unchecked_questions:function unchecked_questions(){var t=this;return this.testing.questions.some((function(i){return!new u.b(t.$store.state,t.attempt,i).is_checked()}))}}},c=r(3),_=Object(c.a)(l,(function(){var t=this,i=t.$createElement,r=t._self._c||i;return r("div",{staticClass:"panel-heading clearfix"},[r("div",{staticClass:"panel-title col-xs-no-padding col-xs-6"},[t.attempt.is_finished&&t.attempt.values.is_publish&&t.attempt.values.is_passed&&!t.unchecked_questions?r("span",{staticClass:"shp-donut shp-donut-success text-top"}):t.attempt.is_finished&&t.attempt.values.is_publish&&!t.attempt.values.is_passed&&!t.unchecked_questions?r("span",{staticClass:"shp-donut shp-donut-danger text-top"}):r("span",{staticClass:"shp-donut shp-donut-info text-top"}),t._v("\n    "+t._s(t.$gettext("Попытка"))+" "+t._s(t.attempt.values.number)+" "+t._s(t.$gettext("из"))+" "+t._s(t.testing.values.max_attempts)+"\n    "),t.attempt.is_finished?t.attempt.values.is_last?r("span",[t._v("("+t._s(t.$gettext("Результаты"))+")")]):t.attempt.values.is_finished?r("span",[t._v("("+t._s(t.$gettext("Завершена"))+")")]):t._e():r("span",[t._v("("+t._s(t.$gettext("Текущая"))+")")])]),t._v(" "),r("div",{staticClass:"col-xs-6 col-xs-no-padding text-right h4 font-14"},[t.show_other||t.attempt.is_finished&&t.last_attempt.values.number>1?r("a",{staticClass:"under-line btn btn-link btn-sm",on:{click:t.open_select}},[t._v(t._s(t.$gettext("Другие попытки")))]):t._e(),t._v(" "),t._t("heading_buttons")],2)])}),[],!1,null,null,null);i.a=_.exports},2419:function(t,i,r){"use strict";r(11),r(7),r(12),r(43);var a=r(843),o=r(622),u=r(97),l=r(22),c=r(330),_={name:"testing-attempt-select",props:{testing:{required:!0,type:o.b},current_id:{required:!1},user_id:{required:!1}},data:function data(){var t=new u.c(l.b["api:testing_testing_attempt_list_api"](this.testing.values.id),c.a),i=new u.a("testing:".concat(this.testing.values.id,":attempt:list"),t).set_limit(100);return this.user_id&&this.user_id!==this.$store.state.login.user_data&&(t=new u.c(l.b["api:testing_attempt_list_api"](),c.a),i=new u.a("testing:".concat(this.testing.values.id,":attempt:list"),t).add_query_filter({user_id:this.user_id,testing_id:this.testing.values.id,orderBy:"-number"}).set_limit(100)),{list_data:i,is_open:!0}},created:function created(){this.list_data.fetch(this.$store)},beforeDestroy:function beforeDestroy(){this.list_data.destroy(this.$store)},methods:{close:function close(){new a.b(this.testing.values.id,this.$store.state).action_operator.detail(this.$store)},open:function open(t){this.$emit("open",t),this.is_open=!1}},computed:{attempts:function attempts(){var t=this;return this.list_data.ids.map((function(i){return c.a.get_instance(t.$store,a.a,i)}))}}},p=r(3),d=Object(p.a)(_,(function(){var t=this,i=t.$createElement,r=t._self._c||i;return r("modal",{staticClass:"right modal-no-body",attrs:{title:"Modal 1","append-to-body":!0,footer:!1},on:{hide:t.close},model:{value:t.is_open,callback:function(i){t.is_open=i},expression:"is_open"}},[r("div",{staticClass:"text-center",attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$gettext("Результаты прохождений"))+" ")]),t._v(" "),r("div",{staticClass:"list-group list-group-square"},t._l(t.attempts,(function(i){return r("div",{key:i.uid,staticClass:"list-group-item clickable clearfix",class:{active:i.values.id===t.current_id},on:{click:function(r){return t.open(i.values.id)}}},[r("div",{staticClass:"col-xs-1"},[i.values.is_last&&i.is_result_published()?i.values.is_passed?r("div",{staticClass:"shp-donut shp-donut-success"}):r("div",{staticClass:"shp-donut shp-donut-danger"}):r("div",{staticClass:"shp-donut shp-donut-info"})]),t._v(" "),r("div",{staticClass:"col-xs-5 text-center testing-attempt-text"},[t._v("\n        "+t._s(t.$gettext("Попытка"))+" "+t._s(i.values.number)+"\n      ")]),t._v(" "),r("div",{staticClass:"col-xs-6 text-right testing-attempt-text"},[i&&!i.is_result_published()?r("span",[t._v("?")]):r("span",[t._v(t._s(i.score.pretty_format()))]),t._v(" / "+t._s(t.testing.score)+"\n      ")])])})),0)])}),[],!1,null,null,null);i.a=d.exports},2715:function(t,i,r){"use strict";r(2330)},2716:function(t,i,r){"use strict";r(2331)},2717:function(t,i,r){"use strict";r(2332)},2718:function(t,i,r){"use strict";r(2333)},2719:function(t,i,r){"use strict";r(2334)},2720:function(t,i,r){"use strict";r(2335)},657:function(t,i,r){"use strict";r.d(i,"a",(function(){return c}));var a=r(6),o=r(330),u=r(658),l=r(707),c=new a.a("unit_users").add_related("testing_attempts",new a.b(o.a).multiple().remove_without_relations()).add_related("run_results",new a.b(u.a).multiple().remove_without_relations()).add_related("scratch_results",new a.b(l.a).multiple().remove_without_relations())},862:function(t,i,r){"use strict";r.d(i,"b",(function(){return R})),r.d(i,"a",(function(){return I}));r(26);var a,o,u,l,c=r(14),_=r.n(c),p=r(15),d=r.n(p),m=r(8),h=r.n(m),v=r(4),g=r.n(v),w=r(5),b=r.n(w),q=r(9),y=r.n(q),x=(r(11),r(7),r(12),r(25),r(43),r(23),r(65),r(28),r(893),r(18)),$=r(887),k=r(1),C=r(17),O=r.n(C),j=r(0);function _createSuper(t){var i=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var r,a=h()(t);if(i){var o=h()(this).constructor;r=Reflect.construct(a,arguments,o)}else r=a.apply(this,arguments);return d()(this,r)}}var E=(a=function(){function InputAnswerScoring(t,i,r){g()(this,InputAnswerScoring),this.state=t,this.attempt=i,this.question_input=r,this._is_custom=("custom"===this.question_input.values.widget||"input"===this.question_input.values.widget)&&this.question_input.values.check_answers}return b()(InputAnswerScoring,[{key:"right_answers",get:function get(){var t=this;return this.answers.filter((function(i){return i.variant&&i.variant.values.is_answer&&(i.variant.values.checked_at&&t._is_custom||!t._is_custom)}))}},{key:"wrong_answers",get:function get(){var t=this;return this.answers.filter((function(i){return i.variant&&!i.variant.values.is_answer&&(i.variant.values.checked_at&&t._is_custom||!t._is_custom)}))}},{key:"is_answered",get:function get(){return this.right_answers.length>0}},{key:"is_errors",get:function get(){return this.wrong_answers.length>0||0===this.answers.length}},{key:"is_checked",get:function get(){return this.right_answers.length+this.wrong_answers.length===this.answers.length}},{key:"is_partial",get:function get(){return this.answers.length&!this.right_answers.length&&!this.wrong_answers.length}},{key:"has_answers",get:function get(){return this.answers.length>0}},{key:"answers",get:function get(){var t=this,i=this.state,r=i.models.testing_attempts[this.attempt.values.id].question_answers||[];return(r=r.filter((function(r){return i.models.question_answers[r]&&i.models.question_answers[r].input_id===t.question_input.values.id}))).map((function(t){return new $.a(i.models.question_answers[t],i)}))}},{key:"percent",get:function get(){return this.right_answers.length?1:0}},{key:"score",get:function get(){return this.percent*this.question_input.get_score()}},{key:"background_color",get:function get(){return this.is_checked?this.is_partial?"warning-background":this.is_errors?"error-background":"success-background":"info-background"}}]),InputAnswerScoring}(),y()(a.prototype,"right_answers",[x.a],Object.getOwnPropertyDescriptor(a.prototype,"right_answers"),a.prototype),y()(a.prototype,"wrong_answers",[x.a],Object.getOwnPropertyDescriptor(a.prototype,"wrong_answers"),a.prototype),y()(a.prototype,"answers",[x.a],Object.getOwnPropertyDescriptor(a.prototype,"answers"),a.prototype),y()(a.prototype,"score",[x.a],Object.getOwnPropertyDescriptor(a.prototype,"score"),a.prototype),a),A=(o=function(t){_()(MultipleVariantAnswerScoring,t);var i=_createSuper(MultipleVariantAnswerScoring);function MultipleVariantAnswerScoring(){return g()(this,MultipleVariantAnswerScoring),i.apply(this,arguments)}return b()(MultipleVariantAnswerScoring,[{key:"is_answered",get:function get(){var t=this;return(this.state.models.question_inputs[this.question_input.values.id].question_variants||[]).filter((function(i){return t.state.models.question_variants[i].is_answer})).length===this.right_answers.length&&!this.wrong_answers.length}},{key:"right_variants",get:function get(){return this.question_input.question_variants.filter((function(t){return t.values.is_answer}))}},{key:"is_errors",get:function get(){var t=this.question_input.values.max_errors;return t=t?parseInt(t):0,!this.right_answers.length||this.is_partial&&this.right_variants.length-this.right_answers.length+this.wrong_answers.length>t}},{key:"is_partial",get:function get(){return!this.is_answered&&this.right_answers.length>0}},{key:"percent",get:function get(){if(this.is_errors)return 0;var t=1*this.question_input.question_variants.filter((function(t){return t.values.is_answer})).length;if(this.question_input.question_variants.length===t)return this.right_answers.length/t;var i=t/(t+(this.question_input.question_variants.length-t)),r=t*(1-i);if(r<=0)return 0;var a=(this.right_answers.length*(1-i)-this.wrong_answers.length*i)/r;return Math.max(a,0)}}]),MultipleVariantAnswerScoring}(E),y()(o.prototype,"right_variants",[x.a],Object.getOwnPropertyDescriptor(o.prototype,"right_variants"),o.prototype),y()(o.prototype,"is_errors",[x.a],Object.getOwnPropertyDescriptor(o.prototype,"is_errors"),o.prototype),y()(o.prototype,"percent",[x.a],Object.getOwnPropertyDescriptor(o.prototype,"percent"),o.prototype),o);function get_input_answer_scoring(t,i,r){return"multiple_variant"===r.values.widget?new A(t,i,r):new E(t,i,r)}var S=(u=function(){function QuestionInputScoring(t,i){g()(this,QuestionInputScoring),this.question_scoring=t,this.input_scoring=i}return b()(QuestionInputScoring,[{key:"is_answered",get:function get(){return this.input_scoring.is_answered}},{key:"is_errors",get:function get(){return this.input_scoring.is_errors}},{key:"is_checked",get:function get(){return this.input_scoring.is_checked}},{key:"is_partial",get:function get(){return this.input_scoring.is_partial}},{key:"has_answers",get:function get(){return this.input_scoring.has_answers}},{key:"score",get:function get(){return this.input_scoring.score}}]),QuestionInputScoring}(),y()(u.prototype,"score",[x.a],Object.getOwnPropertyDescriptor(u.prototype,"score"),u.prototype),u),R=(l=function(){function QuestionScoring(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(k.isRequired)(),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(k.isRequired)(),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object(k.isRequired)();g()(this,QuestionScoring),this.question=r,this.attempt=i,this.inputs_scoring=r.inputs.map((function(r){return get_input_answer_scoring(t,i,r)}))}return b()(QuestionScoring,[{key:"get_input_scoring",value:function get_input_scoring(t){return this.inputs_scoring.find((function(i){return i.question_input.values.id===t}))}},{key:"get_question_input_scoring",value:function get_question_input_scoring(t){return new S(this,this.get_input_scoring(t))}},{key:"score",get:function get(){var t=0;return this.question.values.max_errors<this.errors_amount?0:(this.inputs_scoring.forEach((function(i){t+=i.score})),t)}},{key:"errors_amount",get:function get(){return this.inputs_scoring.filter((function(t){return 0!==t.wrong_answers.length})).length}},{key:"is_checked",value:function is_checked(){var t=!0;return this.inputs_scoring.forEach((function(i){t&=i.is_checked})),t}},{key:"show_wrong_answers",get:function get(){return!(!this.attempt||!this.attempt.is_result_published())&&(this.attempt.testing&&this.attempt.testing.values.show_wrong_answers)}},{key:"is_partial",value:function is_partial(){return this.is_errors()&&this.is_have_result()}},{key:"is_have_result",value:function is_have_result(){var t=!1;return this.inputs_scoring.forEach((function(i){t|=i.is_partial})),t|=Boolean(this.inputs_scoring.find((function(t){return t.is_errors}))&&this.inputs_scoring.find((function(t){return!t.is_errors})))}},{key:"is_errors",value:function is_errors(){var t=!1;return this.inputs_scoring.forEach((function(i){t|=i.is_partial})),t|=Boolean(this.inputs_scoring.find((function(t){return t.is_errors})))}},{key:"has_answers",value:function has_answers(){var t=!1;return this.inputs_scoring.forEach((function(i){t|=i.has_answers})),t}},{key:"background_color",get:function get(){return this.has_answers()?this.is_checked()?this.is_partial()?"warning-background":this.is_errors()?"error-background":"success-background":"info-background":""}},{key:"get_label_color",value:function get_label_color(){return this.has_answers()?this.is_checked()?this.is_partial()?"label-warning":this.is_errors()?"label-danger":"label-success":"label-info":""}},{key:"score_text",value:function score_text(t){if(!(t||this.attempt.is_finished&&this.attempt.values.is_last))return Object(j.$gettext)("? баллов");var i=O.a.prototype.$ngettext("балл","балла",Math.trunc(this.score));return this.score.pretty_format(2)+" "+i}}]),QuestionScoring}(),y()(l.prototype,"score",[x.a],Object.getOwnPropertyDescriptor(l.prototype,"score"),l.prototype),y()(l.prototype,"errors_amount",[x.a],Object.getOwnPropertyDescriptor(l.prototype,"errors_amount"),l.prototype),l),I=function(){function AttemptScoring(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(k.isRequired)(),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(k.isRequired)();g()(this,AttemptScoring),this.state=t,this.attempt=i,this._cache={}}return b()(AttemptScoring,[{key:"get_question_scoring",value:function get_question_scoring(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(k.isRequired)(),i=t.values.id;return this._cache.hasOwnProperty(i)||(this._cache[i]=new R(this.state,this.attempt,t)),this._cache[i]}}]),AttemptScoring}()}}]);
//# sourceMappingURL=32.32.aa605168277ff0c0c014.js.map